<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC: Developing Code Using SC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPQC
   &#160;<span id="projectnumber">2.3.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Developing Code Using SC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In addition to the executables, the Scientific Computing toolkit libraries and include files can be installed on your machine. This is described in the <a class="el" href="compile.html">Compiling</a> section of this manual.</p>
<p>The <code>sc-config</code> program can be use to obtain the compilers, compiler options, and libraries needed to use the SC toolkit from your program. This utility is discussed below, along with how the SC toolkit must be initialized in your <code>main</code> subroutine.</p>
<ul>
<li>
<a class="el" href="develop.html#scconfig">The sc-config Program</a> </li>
<li>
<a class="el" href="develop.html#scinit">Initializing SC</a> </li>
<li>
<a class="el" href="develop.html#devsamp">MP2 Implementation Example</a> </li>
<li>
<a class="el" href="develop.html#scexcept">Exception Handling in SC</a> </li>
<li>
<a class="el" href="develop.html#devcheck">Adding Test Cases to the Verification Suite</a> </li>
</ul>
<h1><a class="anchor" id="scconfig"></a>
The sc-config Program</h1>
<p>The sc-config program returns information about how SC was compiled and installed. See <a class="el" href="sc-config.html">sc-config</a> for more information. <br  />
</p>
<h1><a class="anchor" id="scinit"></a>
Initializing SC</h1>
<p>First the execution environment must be initialized using the ExEnv init member.</p>
<pre>
  ExEnv::init(argc, argv);
</pre><p>By default, all output will go to the console stream, cout. To change this, use the following code:</p>
<pre>
  ostream *outstream = new ofstream(outputfilename);
  ExEnv::set_out(outstream);
</pre><p>MPI is allowed wait until MPI_Init is called to fill in argc and argv, so you may have to call MPI_Init before you even know that we ready to construct MPIMessageGrp. So if an MPIMessageGrp is needed, it is up to the developer to call MPI_Init to get the argument list for certain MPI implementations.</p>
<pre>
  MPI_Init(&amp;argc, &amp;argv);
</pre><p>When files are read and written, an extension is added to a basename to construct the file name. The default is "SC". To use another basename, make the following call, where <code>basename</code> is a <code>const char *</code>:</p>
<pre>
  SCFormIO::set_default_basename(basename);
</pre><p>If your job might run in parallel, then make the following call or the nodes will print redundant information. The <code>myproc</code> argument is the rank of the called node.</p>
<pre>
  SCFormIO::init_mp(myproc);
</pre><p>This segment of code sets up an object to provide multi-threading:</p>
<pre>
  RefThreadGrp thread = ThreadGrp::initial_threadgrp(argc, argv);
  ThreadGrp::set_default_threadgrp(thread);
  if (thread.nonnull())
    ThreadGrp::set_default_threadgrp(thread);
  else
    thread = ThreadGrp::get_default_threadgrp();
</pre><p>This segment of code sets up the message passing object:</p>
<pre>
  RefMessageGrp grp = MessageGrp::initial_messagegrp(argc, argv);
  if (grp.nonnull())
    MessageGrp::set_default_messagegrp(grp);
  else
    grp = MessageGrp::get_default_messagegrp();
</pre><h1><a class="anchor" id="devsamp"></a>
MP2 Implementation Example</h1>
<p>This section illustrates how to add a new method a new method to MPQC.</p>
<h2><a class="anchor" id="devsampsrc"></a>
MP2 Implementation Example: Source</h2>
<p>This example code illustrates a complete MP2 energy implementation using the SC Toolkit. First an MP2 class is declared and the necesary base class member functions are provided. Next a ClassDesc is defined. Finally, the member functions are defined.</p>
<p>Note that no main routine is provided. This is because this file is designed to be used to extend the functionality of the mpqc executable. To generate a new mpqc executable with the new class available for use, see the <a class="el" href="develop.html#devsampmak">MP2 Implementation Example: Makefile</a> section.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/misc/autovec.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/misc/scexception.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/wfn/obwfn.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/scf/clhf.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>sc;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MP2: <span class="keyword">public</span> <a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a> {</div>
<div class="line">    <a class="code" href="classsc_1_1Ref.html">Ref&lt;OneBodyWavefunction&gt;</a> ref_mp2_wfn_;</div>
<div class="line">    <span class="keywordtype">double</span> compute_mp2_energy();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>: </div>
<div class="line">    MP2(<span class="keyword">const</span> <a class="code" href="classsc_1_1Ref.html">Ref&lt;KeyVal&gt;</a> &amp;);</div>
<div class="line">    MP2(<a class="code" href="classsc_1_1StateIn.html">StateIn</a> &amp;);</div>
<div class="line">    <span class="keywordtype">void</span> save_data_state(<a class="code" href="classsc_1_1StateOut.html">StateOut</a> &amp;);</div>
<div class="line">    <span class="keywordtype">void</span> compute(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">void</span> obsolete(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">int</span> nelectron(<span class="keywordtype">void</span>);</div>
<div class="line">    <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> density(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">int</span> spin_polarized(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">int</span> value_implemented(<span class="keywordtype">void</span>) <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="classsc_1_1ClassDesc.html">ClassDesc</a> MP2_cd(<span class="keyword">typeid</span>(MP2), <span class="stringliteral">&quot;MP2&quot;</span>, 1, <span class="stringliteral">&quot;public Wavefunction&quot;</span>,</div>
<div class="line">                        0, create&lt;MP2&gt;, create&lt;MP2&gt;);</div>
<div class="line"> </div>
<div class="line">MP2::MP2(<span class="keyword">const</span> <a class="code" href="classsc_1_1Ref.html">Ref&lt;KeyVal&gt;</a> &amp;keyval):<a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a>(keyval) {</div>
<div class="line">  ref_mp2_wfn_ &lt;&lt; keyval-&gt;<a class="code" href="classsc_1_1KeyVal.html#a1a53bd0f1706a9a54fd9d898a610ab51">describedclassvalue</a>(<span class="stringliteral">&quot;reference&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span>(ref_mp2_wfn_.null()) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1InputError.html">InputError</a>(<span class="stringliteral">&quot;require a OneBodyWavefunction object&quot;</span>,</div>
<div class="line">                       __FILE__, __LINE__, <span class="stringliteral">&quot;reference&quot;</span>, 0,</div>
<div class="line">                       <a class="code" href="classsc_1_1DescribedClass.html#ad0139393a03f715cea357d2f71d2af95">class_desc</a>());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">MP2::MP2(<a class="code" href="classsc_1_1StateIn.html">StateIn</a> &amp;statein):<a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a>(statein)</div>
<div class="line">{</div>
<div class="line">  ref_mp2_wfn_ &lt;&lt; <a class="code" href="classsc_1_1SavableState.html#a01c14e9cff8a3a586e9cb36bcd049799">SavableState::restore_state</a>(statein);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::save_data_state(<a class="code" href="classsc_1_1StateOut.html">StateOut</a> &amp;stateout) {</div>
<div class="line">  <a class="code" href="classsc_1_1Wavefunction.html#a7acd34ddf2ab8eec66dfdbd6b190d5c2">Wavefunction::save_data_state</a>(stateout);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1SavableState.html#afe8ddc4e284265dcb3174d321471a1b0">SavableState::save_state</a>(ref_mp2_wfn_.pointer(),stateout);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::compute(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(gradient_needed()) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;no gradients yet&quot;</span>,</div>
<div class="line">                                  __FILE__, __LINE__, class_desc());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> extra_hf_acc = 10.;</div>
<div class="line">  ref_mp2_wfn_-&gt;set_desired_value_accuracy(desired_value_accuracy()</div>
<div class="line">                                           / extra_hf_acc);</div>
<div class="line">  <span class="keywordtype">double</span> refenergy = ref_mp2_wfn_-&gt;energy();</div>
<div class="line">  <span class="keywordtype">double</span> mp2energy = compute_mp2_energy();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">ExEnv::out0</a>() &lt;&lt; indent &lt;&lt; <span class="stringliteral">&quot;MP2 Energy = &quot;</span> &lt;&lt; mp2energy &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">  set_value(refenergy + mp2energy);</div>
<div class="line">  set_actual_value_accuracy(ref_mp2_wfn_-&gt;actual_value_accuracy()</div>
<div class="line">                            * extra_hf_acc);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::obsolete(<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code" href="classsc_1_1Wavefunction.html#a595e2b893f887458c49b8872e4dde606">Wavefunction::obsolete</a>();</div>
<div class="line">  ref_mp2_wfn_-&gt;obsolete();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">MP2::nelectron(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">return</span> ref_mp2_wfn_-&gt;nelectron();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a></div>
<div class="line">MP2::density(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;no density yet&quot;</span>,</div>
<div class="line">                              __FILE__, __LINE__, class_desc());</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">MP2::spin_polarized(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">MP2::value_implemented(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{</div>
<div class="line">  <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span></div>
<div class="line">MP2::compute_mp2_energy()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(molecule()-&gt;point_group()-&gt;char_table().order() != 1) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;C1 symmetry only&quot;</span>,</div>
<div class="line">                                  __FILE__, __LINE__, class_desc());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSCMatrix.html">RefSCMatrix</a> vec = ref_mp2_wfn_-&gt;eigenvectors();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nao = vec.nrow();</div>
<div class="line">  <span class="keywordtype">int</span> nmo = vec.ncol();</div>
<div class="line">  <span class="keywordtype">int</span> nocc = ref_mp2_wfn_-&gt;nelectron()/2;</div>
<div class="line">  <span class="keywordtype">int</span> nvir = nmo - nocc;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> cvec_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [vec.nrow() * vec.ncol()]);</div>
<div class="line">  <span class="keywordtype">double</span> *cvec = cvec_av.<a class="code" href="classsc_1_1auto__vec.html#ae48f1488f2ae2e1c77b8c4fb09e57615">get</a>();</div>
<div class="line">  vec-&gt;convert(cvec);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> pqrs_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nao * nao * nao * nao]);</div>
<div class="line">  <span class="keywordtype">double</span> *pqrs = pqrs_av.get();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt; nao*nao*nao*nao; n++) pqrs[n] = 0.0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;TwoBodyInt&gt;</a> twoint = integral()-&gt;electron_repulsion();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> *buffer = twoint-&gt;<a class="code" href="classsc_1_1TwoBodyInt.html#ad86e1b4e857f12cad4cca47ba1009fcb">buffer</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;GaussianBasisSet&gt;</a> basis = this-&gt;basis();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nshell = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a2e664884d5a54f80d8bdc07a84cc6cab">nshell</a>();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> P = 0; P &lt; nshell; P++) {</div>
<div class="line">    <span class="keywordtype">int</span> nump = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a53839bcfee1777500e4375aba6c18fda">shell</a>(P).<a class="code" href="classsc_1_1GaussianShell.html#aa6cb22737e2eac2c8d697a1761d34684">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Q = 0; Q &lt; nshell; Q++) {</div>
<div class="line">      <span class="keywordtype">int</span> numq = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a53839bcfee1777500e4375aba6c18fda">shell</a>(Q).<a class="code" href="classsc_1_1GaussianShell.html#aa6cb22737e2eac2c8d697a1761d34684">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> R = 0; R &lt; nshell; R++) {</div>
<div class="line">        <span class="keywordtype">int</span> numr = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a53839bcfee1777500e4375aba6c18fda">shell</a>(R).<a class="code" href="classsc_1_1GaussianShell.html#aa6cb22737e2eac2c8d697a1761d34684">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> S = 0; S &lt; nshell; S++) {</div>
<div class="line">          <span class="keywordtype">int</span> nums = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a53839bcfee1777500e4375aba6c18fda">shell</a>(S).<a class="code" href="classsc_1_1GaussianShell.html#aa6cb22737e2eac2c8d697a1761d34684">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">          twoint-&gt;<a class="code" href="classsc_1_1TwoBodyInt.html#a8d1110a67d7886e6251a5d8158f603ed">compute_shell</a>(P,Q,R,S);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> index = 0;</div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0; p &lt; nump; p++) {</div>
<div class="line">            <span class="keywordtype">int</span> op = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(P)+p;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> q = 0; q &lt; numq; q++) {</div>
<div class="line">              <span class="keywordtype">int</span> oq = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(Q)+q;</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 0; r &lt; numr; r++) {</div>
<div class="line">                <span class="keywordtype">int</span> oor = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(R)+r;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s = 0; s &lt; nums; s++,index++) {</div>
<div class="line">                  <span class="keywordtype">int</span> os = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(S)+s;</div>
<div class="line"> </div>
<div class="line">                  <span class="keywordtype">int</span> ipqrs = (((op*nao+oq)*nao+oor)*nao+os);</div>
<div class="line"> </div>
<div class="line">                  pqrs[ipqrs] = buffer[index];</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  twoint = 0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> ijkl_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nmo * nmo * nmo * nmo]);</div>
<div class="line">  <span class="keywordtype">double</span> *ijkl = ijkl_av.get();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nmo; i++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nmo; j++) {</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; nmo; k++) {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; nmo; l++, idx++) {</div>
<div class="line"> </div>
<div class="line">          ijkl[idx] = 0.0;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> index = 0;</div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p = 0; p &lt; nao; p++) {</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> q = 0; q &lt; nao; q++) {</div>
<div class="line">              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 0; r &lt; nao; r++) {</div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s = 0; s &lt; nao; s++,index++) {</div>
<div class="line"> </div>
<div class="line">                  ijkl[idx] += cvec[p*nmo + i] * cvec[q*nmo +j]</div>
<div class="line">                    * cvec[r*nmo + k] * cvec[s*nmo + l]</div>
<div class="line">                    * pqrs[index];</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  pqrs_av.<a class="code" href="classsc_1_1auto__vec.html#a034424ec9616009b1346a834cd515f21">release</a>(); pqrs = 0;</div>
<div class="line">  cvec_av.release(); cvec = 0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> evals_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nmo]);</div>
<div class="line">  <span class="keywordtype">double</span> *evals = evals_av.get();</div>
<div class="line">  ref_mp2_wfn_-&gt;eigenvalues()-&gt;convert(evals);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> energy = 0.0;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; nocc; i++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt; nocc; j++) {</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a=nocc; a &lt; nmo; a++) {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=nocc; b &lt; nmo; b++) {</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> iajb = (((i*nmo+a)*nmo+j)*nmo+b);</div>
<div class="line">          <span class="keywordtype">int</span> ibja = (((i*nmo+b)*nmo+j)*nmo+a);</div>
<div class="line"> </div>
<div class="line">          energy += (2 * ijkl[iajb] - ijkl[ibja]) * ijkl[iajb]/</div>
<div class="line">            (evals[i] + evals[j] - evals[a] - evals[b]);</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ijkl_av.release(); ijkl = 0;</div>
<div class="line">  evals_av.release(); evals = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> energy;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="devsampmak"></a>
MP2 Implementation Example: Makefile</h2>
<p>This example Makefile demonstrates how to link in a new class to form a new mpqc executable, here named mp2. The code is given in the <a class="el" href="develop.html#devsampsrc">MP2 Implementation Example: Source</a> section. The <a class="el" href="develop.html#scconfig">sc-config command</a> is used to obtain information about how the SC toolkit was compiled and installed. The library specified with -lmpqc provides the main routine from mpqc.</p>
<div class="fragment"><div class="line"># Change this to the path to your installed sc-config script.</div>
<div class="line">SCCONFIG = /usr/local/mpqc/current/bin/sc-config</div>
<div class="line">CXX := $(shell $(SCCONFIG) --cxx)</div>
<div class="line">CXXFLAGS := $(shell $(SCCONFIG) --cxxflags)</div>
<div class="line">CPPFLAGS := $(shell $(SCCONFIG) --cppflags)</div>
<div class="line">LIBS := $(shell $(SCCONFIG) --libs)</div>
<div class="line">LIBDIR  := $(shell $(SCCONFIG) --libdir)</div>
<div class="line">LTLINK := $(shell $(SCCONFIG) --ltlink)</div>
<div class="line">LTLINKBINOPTS := $(shell $(SCCONFIG) --ltlinkbinopts)</div>
<div class="line"> </div>
<div class="line">mp2: mp2.o</div>
<div class="line">        $(LTLINK) $(CXX) $(CXXFLAGS) -o $@ $^ -L$(LIBDIR) -lmpqc $(LIBS) $(LTLINKBINOPTS)</div>
</div><!-- fragment --><h2><a class="anchor" id="devsampinp"></a>
MP2 Implementation Example: Input</h2>
<p>This input file can be used with the program illustrated in the <a class="el" href="develop.html#devsampsrc">MP2 Implementation Example: Source</a> section. It will compute the MP2 energy using the new MP2 class. Note that only the <a class="el" href="mpqcoo.html">object-oriented input format</a> can be used with user provided classes.</p>
<div class="fragment"><div class="line">% emacs should use -*- KeyVal -*- mode</div>
<div class="line">molecule&lt;Molecule&gt;: (</div>
<div class="line">  symmetry = C1</div>
<div class="line">  unit = angstrom</div>
<div class="line">  { atoms geometry } = {</div>
<div class="line">    O     [     0.00000000     0.00000000     0.37000000 ]</div>
<div class="line">    H     [     0.78000000     0.00000000    -0.18000000 ]</div>
<div class="line">    H     [    -0.78000000     0.00000000    -0.18000000 ]</div>
<div class="line">  }</div>
<div class="line">)</div>
<div class="line">basis&lt;GaussianBasisSet&gt;: (</div>
<div class="line">  name = &quot;STO-3G&quot;</div>
<div class="line">  molecule = $:molecule</div>
<div class="line">)</div>
<div class="line">mpqc: (</div>
<div class="line">  checkpoint = no</div>
<div class="line">  savestate = no</div>
<div class="line">  % MP2 is the new class.  Change MP2 to MBPT2 to test</div>
<div class="line">  % against the standard MP2 code</div>
<div class="line">  mole&lt;MP2&gt;: (</div>
<div class="line">    molecule = $:molecule</div>
<div class="line">    basis = $:basis</div>
<div class="line">    reference&lt;CLHF&gt;: (</div>
<div class="line">      molecule = $:molecule</div>
<div class="line">      basis = $:basis</div>
<div class="line">      memory = 16000000</div>
<div class="line">    )</div>
<div class="line">  )</div>
<div class="line">)</div>
<div class="line"> </div>
</div><!-- fragment --><h1><a class="anchor" id="scexcept"></a>
Exception Handling in SC</h1>
<p>The development of SC began before exception handling was available in C++. A retrofit of the code to use exceptions is in progress. It is difficult to retrofit a code, especially a parallel code, to do exception handling. There will be some limitations: exception handling will not work well for parallel jobs, objects whose members throw might be left in a questionable state, etc. However, it is intended that SC objects will be usable in an interactive environment. It is also planned that exceptions be used internally to facilitate recover from certain problems.</p>
<p>All new code should use exceptions instead of exit or abort and allocate resources in such a way that, if an exception occurs, all resources such as memory or locks are released. A hierarchy of exception classes has been created that maps better to scientific computing than the standard exceptions. More information is below, as well as in the documentation for the SCException class and its derivatives.</p>
<ul>
<li>
<a class="el" href="develop.html#scexceptmem">Exceptions and Memory Allocation</a> </li>
<li>
<a class="el" href="develop.html#scexceptlocks">Exceptions and Locks</a> </li>
<li>
<a class="el" href="develop.html#scexcepttimer">Exceptions and Region Timers</a> </li>
<li>
<a class="el" href="develop.html#scexceptexample">Using the SC Exception Classes</a> </li>
<li>
<a class="el" href="develop.html#scexceptdebug">Debugging Code with Exceptions</a> </li>
</ul>
<h2><a class="anchor" id="scexceptmem"></a>
Exceptions and Memory Allocation</h2>
<p>Consider the following code fragment:</p>
<pre>
Object *obj = new Object;
double *array = new double[n];</pre><pre>f(obj, array, mol);</pre><pre>delete obj;
delete[] array;
</pre><p>If an exception is thrown in the function f(), then storage for array and obj will not be released. The standard C++ library provides a class, auto_ptr, to deal with obj, and the SC toolkit provides a class, auto_vec, to deal with array.</p>
<p>The include files for these two classes are:</p>
<pre>
#include &lt;memory&gt;
#include &lt;<a class="el" href="autovec_8h_source.html">util/misc/autovec.h</a>&gt;
</pre><p>the code would be modified as follows:</p>
<pre>
std::auto_ptr&lt;Object&gt; obj(new Object);
sc::auto_vec&lt;double&gt; array(new double[n]);</pre><pre>f(obj.get(), array.get());</pre><pre>obj.release();  // or just let the destructor release it
array.release();  // or just let the destructor release it
</pre><p>Note that when <a class="el" href="classsc_1_1Ref.html" title="A template class that maintains references counts.">sc::Ref</a> is used to store pointers, the storage will automatically be released when necessary. No special treatment is needed to deal with exceptions.</p>
<h2><a class="anchor" id="scexceptlocks"></a>
Exceptions and Locks</h2>
<p>Consider the following code fragment:</p>
<pre>
g(const sc::Ref&lt;sc::ThreadLock&gt; &amp;lock)
{
  lock-&gt;lock();
  f();
  lock-&gt;unlock();
}
</pre><p>If f() throws, then the lock is never released. The ThreadLock lock() and unlock() members should not be used anymore. Now do the following:</p>
<pre>
g(const sc::Ref&lt;sc::ThreadLock&gt; &amp;lock)
{
  <a class="el" href="classsc_1_1ThreadLockHolder.html" title="Acquire a lock on creation and release it on destruction.">sc::ThreadLockHolder</a> lockholder(lock);
  f();
  lockholder-&gt;unlock(); // or let the destructor unlock it
}
</pre><h2><a class="anchor" id="scexcepttimer"></a>
Exceptions and Region Timers</h2>
<p>Consider the following code fragment:</p>
<pre>
g(const sc::Ref&lt;sc::RegionTimer&gt; &amp;regtim)
{
  regtim-&gt;enter("f()");
  f();
  regtim-&gt;exit();
}
</pre><p>If f() throws, then the "f()" timing region is never exited. Instead use the following:</p>
<pre>
g(const sc::Ref&lt;sc::RegionTimer&gt; &amp;regtim)
{
  <a class="el" href="classsc_1_1Timer.html" title="The Timer class uses RegionTimer to time intervals in an exception safe manner.">sc::Timer</a> timer(regtim, "f()");
  f();
  timer.reset(); // or let the destructor exit the region
}
</pre><h2><a class="anchor" id="scexceptexample"></a>
Using the SC Exception Classes</h2>
<p>The SC exceptions provide information that can be used into two ways. First, text information is provided so that if the exception is not caught at a lower level, then the mpqc executable will catch it and write information about the problem to the terminal or an output file. Second, information about the nature of the problem is provided, to permit developers to catch the exception and deal with it in some way. The documentation for <a class="el" href="classsc_1_1SCException.html" title="This is a std::exception specialization that records information about where an exception took place.">sc::SCException</a> and all of its derivatives gives more information about the exceptions that are available. As an example, consider the following loop, where a maximum number of iterations is permitted:</p>
<pre>
XYZ::update()
{
  for (int i=0; i&lt;maxiter; i++) {
    // ... compute xyz update ...
    if (residual &lt; threshold) return;
  }
  throw MaxIterExceeded("too many iterations xyz computation",
                        __FILE__, __LINE__, maxiter, class_desc());
}
</pre><p>The first argument to the exception class is a brief description of the error. Additional information can be provided, see SCException::elaborate() description below. The next two arguments are the filename and line number. The C preprocessor provides these for you with the <b>FILE</b> and <b>LINE</b> macros. The next argument is specific to the MaxIterExceeded exception; it is the maximum number of iterations. Finally, a ClassDesc* can be given, which will be used to print out the class name of the object that failed. All of these arguments are optional; however, the first three should always be given.</p>
<p>It is possible to provide additional information using the SCException::elaborate() member. This will return a ostream, and the additional information can be written to this stream. However, if for some reason it is not possible to write to this stream (say, there wasn't enough memory to allocate it), then an exception will be thrown. For this reason, the string description given as the first argument should be informative since the additional information might not be available, and attempts to use elaborate() should be in a try block. So, for example, the elaborate() member could be used in the above example as follows:</p>
<pre>
XYZ::update()
{
  for (int i=0; i&lt;maxiter; i++) {
    // ... compute xyz update ...
    if (residual &lt; threshold) return;
  }
  MaxIterExceeded ex("too many iterations in xyz computation",
                     __FILE__, __LINE__, maxiter, class_desc());
  try {
    ex.elaborate() &lt;&lt; "this can happen when the stepsize is too small"
                   &lt;&lt; std::endl
                   &lt;&lt; "the stepsize is " &lt;&lt; stepsize
                   &lt;&lt; std::endl;
  }
  catch (...) {}
  throw ex;
}
</pre><p>Note that writing to stream returned by elaborate() won't necessarily cause anything to get written to the terminal or an output file. The information will be available when the what() member is called, if writing to the stream succeeds. If the exception is caught by the mpqc main routine, then it will be printed for the user to see. If the program catches the exception and determines that it is possible to proceed in a different way, then the user will never see the text.</p>
<h2><a class="anchor" id="scexceptdebug"></a>
Debugging Code with Exceptions</h2>
<p>Usually, exceptions are not the desired behaviour in a program, and it is necessary to debug a program that throws an exception. This was easy when abort was called, because abort would raise a signal that was caught by the debugger and the code is stopped at the appropriate place. With exceptions the matter is more complex, because the stack is unwound when an exception is thrown and most debugging information is lost. To work around this problem, a breakpoint can be set in code that will be reached only in an exception, and will be run before the stack unwind begins. A useful place to do this when GCC is used as the compiler is in the routine __cxa_allocate_exception(). So, in gdb, the following could be done:</p>
<pre>
$ gdb ./scextest
(gdb) b main
(gdb) run
Breakpoint 1, main () at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:172
172           f();
(gdb) b __cxa_allocate_exception
(gdb) cont
Breakpoint 2, 0x40582d46 in __cxa_allocate_exception ()
   from /usr/lib/gcc-lib/i686-pc-linux-gnu/3.3.5/libstdc++.so.5
(gdb) where
#0  0x40582d46 in __cxa_allocate_exception ()
   from /usr/lib/gcc-lib/i686-pc-linux-gnu/3.3.5/libstdc++.so.5
#1  0x0804b3f7 in f () at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:60
#2  0x0804b9e9 in main ()
    at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:172
</pre><p>Giving gdb "b main" followed by "run" was required before gdb could find the __cxa_allocate_exception symbol.</p>
<h1><a class="anchor" id="devcheck"></a>
Adding Test Cases to the Verification Suite</h1>
<p>There are two ways to test an MPQC build. The <code>testbuild</code> and <code>testrun</code> make targets can be used to run test programs in various library directories, and the <code>check</code> and related make targets can be used to run MPQC on sets of input files. See <a class="el" href="mpqcval.html">Validating MPQC</a> for more information about how to run the tests.</p>
<p>Test programs can be added to the library directories by providing a source file with a main routine. The set of test programs that is to be built and run by <code>testbuild</code> and <code>testrun</code>, respectively, is given by the <code>TESTPROGS</code> variable in the library's <code>Makefile</code>. It may be necessary for an explicit rule to be given for building the test program to ensure that necessary libraries are linked in. If a file named after the test program with a <code>.out</code> suffix is found in the source directory, then <code>testrun</code> fail if the command's output differs from that file. Care must be taken to ensure that the output is architecture independent in this case. Otherwise, <code>testrun</code> will fail only if running the command results in a nonzero return code.</p>
<p>Additional MPQC test inputs can be added in the <code>src/bin/mpqc/validate</code> directory. These inputs can be provided in one of two ways. An input which is used to automatically generate multiple test cases can be written (with a <code>.qci</code> suffix), or a subdirectory with each input can be made. See <code>Makefile</code>, <code>basis1.qci</code>, and <code>input</code> in the <code>src/bin/mpqc/validate</code> directory for examples.</p>
<p>After you have added new inputs and modified the Makefile, change into the <code>src/bin/mpqc/validate</code> subdirectory of your object directory (where you compiled MPQC) and type <code>make inputs</code>. This will create a <code>input</code> subdirectory containing MPQC input files with a <code>.in</code> suffix. Files ending with a <code>.qci</code> suffix will also be placed in the <code>input</code> directory. These contain a description of the calculation that is used by the utility program that checks the results of the validation suite. Both the <code>.in</code> and <code>.qci</code> files for the new test cases must be copied into the <code>ref</code> directory in the source tree. Note that inputs that are not useful in your build environment are not created by <code>make inputs</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclasssc_1_1DescribedClass_html_ad0139393a03f715cea357d2f71d2af95"><div class="ttname"><a href="classsc_1_1DescribedClass.html#ad0139393a03f715cea357d2f71d2af95">sc::DescribedClass::class_desc</a></div><div class="ttdeci">ClassDesc * class_desc() const</div><div class="ttdoc">This returns the unique pointer to the ClassDesc corresponding to the given type_info object.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianShell_html_aa6cb22737e2eac2c8d697a1761d34684"><div class="ttname"><a href="classsc_1_1GaussianShell.html#aa6cb22737e2eac2c8d697a1761d34684">sc::GaussianShell::nfunction</a></div><div class="ttdeci">int nfunction() const</div><div class="ttdoc">The number of basis functions.</div><div class="ttdef"><b>Definition:</b> gaussshell.h:133</div></div>
<div class="ttc" id="aclasssc_1_1RefSymmSCMatrix_html"><div class="ttname"><a href="classsc_1_1RefSymmSCMatrix.html">sc::RefSymmSCMatrix</a></div><div class="ttdoc">The RefSymmSCMatrix class is a smart pointer to an SCSymmSCMatrix specialization.</div><div class="ttdef"><b>Definition:</b> matrix.h:261</div></div>
<div class="ttc" id="aclasssc_1_1RefSCMatrix_html"><div class="ttname"><a href="classsc_1_1RefSCMatrix.html">sc::RefSCMatrix</a></div><div class="ttdoc">The RefSCMatrix class is a smart pointer to an SCMatrix specialization.</div><div class="ttdef"><b>Definition:</b> matrix.h:135</div></div>
<div class="ttc" id="aclasssc_1_1Ref_html"><div class="ttname"><a href="classsc_1_1Ref.html">sc::Ref</a></div><div class="ttdoc">A template class that maintains references counts.</div><div class="ttdef"><b>Definition:</b> ref.h:332</div></div>
<div class="ttc" id="aclasssc_1_1TwoBodyInt_html_ad86e1b4e857f12cad4cca47ba1009fcb"><div class="ttname"><a href="classsc_1_1TwoBodyInt.html#ad86e1b4e857f12cad4cca47ba1009fcb">sc::TwoBodyInt::buffer</a></div><div class="ttdeci">virtual const double * buffer(tbint_type type=eri) const</div><div class="ttdoc">The computed shell integrals will be put in the buffer returned by this member.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a53839bcfee1777500e4375aba6c18fda"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a53839bcfee1777500e4375aba6c18fda">sc::GaussianBasisSet::shell</a></div><div class="ttdeci">const GaussianShell &amp; shell(int i) const</div><div class="ttdoc">Return a reference to GaussianShell number i.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:467</div></div>
<div class="ttc" id="aclasssc_1_1Wavefunction_html"><div class="ttname"><a href="classsc_1_1Wavefunction.html">sc::Wavefunction</a></div><div class="ttdoc">A Wavefunction is a MolecularEnergy that utilizies a GaussianBasisSet.</div><div class="ttdef"><b>Definition:</b> wfn.h:48</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html"><div class="ttname"><a href="classsc_1_1auto__vec.html">sc::auto_vec&lt; double &gt;</a></div></div>
<div class="ttc" id="aclasssc_1_1TwoBodyInt_html_a8d1110a67d7886e6251a5d8158f603ed"><div class="ttname"><a href="classsc_1_1TwoBodyInt.html#a8d1110a67d7886e6251a5d8158f603ed">sc::TwoBodyInt::compute_shell</a></div><div class="ttdeci">virtual void compute_shell(int, int, int, int)=0</div><div class="ttdoc">Given four shell indices, integrals will be computed and placed in the buffer.</div></div>
<div class="ttc" id="aclasssc_1_1InputError_html"><div class="ttname"><a href="classsc_1_1InputError.html">sc::InputError</a></div><div class="ttdoc">This is thrown when invalid input is provided.</div><div class="ttdef"><b>Definition:</b> scexception.h:122</div></div>
<div class="ttc" id="aclasssc_1_1FeatureNotImplemented_html"><div class="ttname"><a href="classsc_1_1FeatureNotImplemented.html">sc::FeatureNotImplemented</a></div><div class="ttdoc">This is thrown when an attempt is made to use a feature that is not yet implemented.</div><div class="ttdef"><b>Definition:</b> scexception.h:102</div></div>
<div class="ttc" id="aclasssc_1_1KeyVal_html_a1a53bd0f1706a9a54fd9d898a610ab51"><div class="ttname"><a href="classsc_1_1KeyVal.html#a1a53bd0f1706a9a54fd9d898a610ab51">sc::KeyVal::describedclassvalue</a></div><div class="ttdeci">Ref&lt; DescribedClass &gt; describedclassvalue(const char *key=0, const KeyValValue &amp;def=KeyValValueRefDescribedClass())</div><div class="ttdoc">Returns a reference to an object of type DescribedClass.</div></div>
<div class="ttc" id="aclasssc_1_1StateIn_html"><div class="ttname"><a href="classsc_1_1StateIn.html">sc::StateIn</a></div><div class="ttdoc">Restores objects that derive from SavableState.</div><div class="ttdef"><b>Definition:</b> statein.h:70</div></div>
<div class="ttc" id="aclasssc_1_1ClassDesc_html"><div class="ttname"><a href="classsc_1_1ClassDesc.html">sc::ClassDesc</a></div><div class="ttdoc">This class is used to contain information about classes.</div><div class="ttdef"><b>Definition:</b> class.h:158</div></div>
<div class="ttc" id="aclasssc_1_1SavableState_html_a01c14e9cff8a3a586e9cb36bcd049799"><div class="ttname"><a href="classsc_1_1SavableState.html#a01c14e9cff8a3a586e9cb36bcd049799">sc::SavableState::restore_state</a></div><div class="ttdeci">static SavableState * restore_state(StateIn &amp;si)</div><div class="ttdoc">Restores objects saved with save_state.</div></div>
<div class="ttc" id="aclasssc_1_1Wavefunction_html_a595e2b893f887458c49b8872e4dde606"><div class="ttname"><a href="classsc_1_1Wavefunction.html#a595e2b893f887458c49b8872e4dde606">sc::Wavefunction::obsolete</a></div><div class="ttdeci">void obsolete()</div><div class="ttdoc">Marks all results as being out of date.</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html_a034424ec9616009b1346a834cd515f21"><div class="ttname"><a href="classsc_1_1auto__vec.html#a034424ec9616009b1346a834cd515f21">sc::auto_vec::release</a></div><div class="ttdeci">T * release()</div><div class="ttdoc">Release ownership.</div><div class="ttdef"><b>Definition:</b> autovec.h:87</div></div>
<div class="ttc" id="aclasssc_1_1StateOut_html"><div class="ttname"><a href="classsc_1_1StateOut.html">sc::StateOut</a></div><div class="ttdoc">Serializes objects that derive from SavableState.</div><div class="ttdef"><b>Definition:</b> stateout.h:61</div></div>
<div class="ttc" id="aclasssc_1_1Wavefunction_html_a7acd34ddf2ab8eec66dfdbd6b190d5c2"><div class="ttname"><a href="classsc_1_1Wavefunction.html#a7acd34ddf2ab8eec66dfdbd6b190d5c2">sc::Wavefunction::save_data_state</a></div><div class="ttdeci">void save_data_state(StateOut &amp;)</div><div class="ttdoc">Save the base classes (with save_data_state) and the members in the same order that the StateIn CTOR ...</div></div>
<div class="ttc" id="aclasssc_1_1SavableState_html_afe8ddc4e284265dcb3174d321471a1b0"><div class="ttname"><a href="classsc_1_1SavableState.html#afe8ddc4e284265dcb3174d321471a1b0">sc::SavableState::save_state</a></div><div class="ttdeci">void save_state(StateOut &amp;)</div><div class="ttdoc">Save the state of the object as specified by the StateOut object.</div></div>
<div class="ttc" id="aclasssc_1_1ExEnv_html_a360216acd1f990e999c0ed46cb350b1f"><div class="ttname"><a href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">sc::ExEnv::out0</a></div><div class="ttdeci">static std::ostream &amp; out0()</div><div class="ttdoc">Return an ostream that writes from node 0.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a6040fbcbccaf6b9e4ae0851d8104a5ef"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">sc::GaussianBasisSet::shell_to_function</a></div><div class="ttdeci">int shell_to_function(int i) const</div><div class="ttdoc">Return the number of the first function in the given shell.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:454</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html_ae48f1488f2ae2e1c77b8c4fb09e57615"><div class="ttname"><a href="classsc_1_1auto__vec.html#ae48f1488f2ae2e1c77b8c4fb09e57615">sc::auto_vec::get</a></div><div class="ttdeci">T * get() const</div><div class="ttdoc">Returns the pointer.</div><div class="ttdef"><b>Definition:</b> autovec.h:81</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a2e664884d5a54f80d8bdc07a84cc6cab"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a2e664884d5a54f80d8bdc07a84cc6cab">sc::GaussianBasisSet::nshell</a></div><div class="ttdeci">int nshell() const</div><div class="ttdoc">Return the number of shells.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:417</div></div>
<hr>
<address>
<small>
Generated at Sun Jan 26 2020 23:33:05 for <a
href="http://www.mpqc.org">MPQC</a>
2.3.1 using the documentation package <a
href="http://www.doxygen.org">Doxygen</a>
1.8.16.
</small>
</address>
</body>
</html>
