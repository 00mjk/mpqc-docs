<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC: Developing Code Using MPQC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPQC
   &#160;<span id="projectnumber">3.0.0-alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('develop.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Developing Code Using MPQC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In addition to the executables, the MPQC toolkit libraries and include files can be installed on your machine. This is described in the <a class="el" href="compile.html">Compiling</a> section of this manual.</p>
<p>The <code>mpqc-config</code> program can be use to obtain the compilers, compiler options, and libraries needed to use the MPQC toolkit from your program. This utility is discussed below, along with how the MPQC toolkit must be initialized in your <code>main</code> subroutine.</p>
<ul>
<li>
<a class="el" href="develop.html#mpqc-config">The mpqc-config Program</a> </li>
<li>
<a class="el" href="develop.html#mpqcinit">Initializing MPQC</a> </li>
<li>
<a class="el" href="develop.html#devsampmp2">Using MPQC's main: MP2 Implementation Example</a> </li>
<li>
<a class="el" href="develop.html#devsamphf">A user-provided main: HF Implementation Example</a> </li>
<li>
<a class="el" href="develop.html#scexcept">Exception Handling in MPQC</a> </li>
<li>
<a class="el" href="develop.html#devcheck">Adding Test Cases to the Verification Suite</a> </li>
</ul>
<h1><a class="anchor" id="mpqc-config"></a>
The mpqc-config Program</h1>
<p>The mpqc-config program returns information about how MPQC was compiled and installed. See <a class="el" href="develop.html#mpqc-config">The mpqc-config Program</a> for more information. <br  />
</p>
<h1><a class="anchor" id="mpqcinit"></a>
Initializing MPQC</h1>
<p>A variety of initializations must be done when a program using the MPQC classes is started. This includes finding out what <a class="el" href="classsc_1_1MessageGrp.html" title="The MessageGrp abstract class provides a mechanism for moving data and objects between nodes in a par...">sc::MessageGrp</a> to be used for communication, what <a class="el" href="classsc_1_1ThreadGrp.html" title="The ThreadGrp abstract class provides a means to manage separate threads of control.">sc::ThreadGrp</a> is to be used for multi-threading, what default <a class="el" href="classsc_1_1Integral.html" title="The Integral abstract class acts as a factory to provide objects that compute one and two electron in...">sc::Integral</a> factory should be used, reading the input file in a way that is efficient on a parallel machine, setting up the output, and so on. The <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a> class simplifies this setup. It is used by first initializing an <a class="el" href="classsc_1_1GetLongOpt.html" title="Parse command line options.">sc::GetLongOpt</a> object. This is used to retrieve flags specified on the command line. The programmer enrolls any desired options into the <a class="el" href="classsc_1_1GetLongOpt.html" title="Parse command line options.">sc::GetLongOpt</a> object and then passes this, along with <code>argc</code> and <code>argv</code>, to the constructor for <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a>. The <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a> class will enroll the options it requires: <code>&ndash;messagegrp</code>, <code>&ndash;threadgrp</code>, <code>&ndash;memory</code>, <code>&ndash;resources</code>, and <code>&ndash;integral</code>. Then the programmer can parse the options and retrieve the value of any flag or obtain anything that was specified on the command line that was not associated with a flag.</p>
<p>Below is a code fragment illustrating the use of <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a>. </p><pre>
  <a class="el" href="classsc_1_1GetLongOpt.html" title="Parse command line options.">sc::GetLongOpt</a> opt;
  opt.usage("[options] [filename]");
  opt.enroll("verbose", GetLongOpt::NoValue, "enable extra printing", 0);</pre><pre>  <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a> init(opt,argc,argv);</pre><pre>  int optind = opt.parse(argc, argv);
  std::string inputfile;
  if (argc - optind == 0) {
    inputfile = "input.in";
  }
  else if (argc - optind == 1) {
    inputfile = argv[optind];
  }
  else {
    opt.usage(std::cout);
    return 1;
  }</pre><pre>  sc::Ref&lt;sc::KeyVal&gt; keyval = init.init(inputfile);
</pre><h1><a class="anchor" id="devsampmp2"></a>
Using MPQC's main: MP2 Implementation Example</h1>
<p>This section illustrates how to add a new quantum chemistry method implementation to MPQC.</p>
<h2><a class="anchor" id="devsampmp2src"></a>
MP2 Implementation Example: Source</h2>
<p>This example code illustrates a complete MP2 energy implementation using the MPQC Toolkit. First an MP2 class is declared and the necesary base class member functions are provided. Next a ClassDesc is defined. Finally, the member functions are defined.</p>
<p>Note that no main routine is provided. This is because this file is designed to be used to extend the functionality of the mpqc executable. To generate a new mpqc executable with the new class available for use, see the <a class="el" href="develop.html#devsampmp2mak">MP2 Implementation Example: Makefile</a> section.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/misc/autovec.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/misc/scexception.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/wfn/obwfn.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/scf/clhf.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacesc.html">sc</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MP2: <span class="keyword">public</span> <a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a> {</div>
<div class="line">    <a class="code" href="classsc_1_1Ref.html">Ref&lt;OneBodyWavefunction&gt;</a> ref_mp2_wfn_;</div>
<div class="line">    <span class="keywordtype">double</span> compute_mp2_energy();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>: </div>
<div class="line">    MP2(<span class="keyword">const</span> <a class="code" href="classsc_1_1Ref.html">Ref&lt;KeyVal&gt;</a> &amp;);</div>
<div class="line">    MP2(<a class="code" href="classsc_1_1StateIn.html">StateIn</a> &amp;);</div>
<div class="line">    <span class="keywordtype">void</span> save_data_state(<a class="code" href="classsc_1_1StateOut.html">StateOut</a> &amp;);</div>
<div class="line">    <span class="keywordtype">void</span> compute(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">void</span> obsolete(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">int</span> nelectron(<span class="keywordtype">void</span>);</div>
<div class="line">    <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> density(<span class="keywordtype">void</span>);</div>
<div class="line">    <span class="keywordtype">double</span> magnetic_moment() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">int</span> value_implemented(<span class="keywordtype">void</span>) <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="classsc_1_1ClassDesc.html">ClassDesc</a> MP2_cd(<span class="keyword">typeid</span>(MP2), <span class="stringliteral">&quot;MP2&quot;</span>, 1, <span class="stringliteral">&quot;public Wavefunction&quot;</span>,</div>
<div class="line">                        0, create&lt;MP2&gt;, create&lt;MP2&gt;);</div>
<div class="line"> </div>
<div class="line">MP2::MP2(<span class="keyword">const</span> <a class="code" href="classsc_1_1Ref.html">Ref&lt;KeyVal&gt;</a> &amp;keyval):<a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a>(keyval) {</div>
<div class="line">  ref_mp2_wfn_ &lt;&lt; keyval-&gt;<a class="code" href="classsc_1_1KeyVal.html#a1a53bd0f1706a9a54fd9d898a610ab51">describedclassvalue</a>(<span class="stringliteral">&quot;reference&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span>(ref_mp2_wfn_.null()) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1InputError.html">InputError</a>(<span class="stringliteral">&quot;require a OneBodyWavefunction object&quot;</span>,</div>
<div class="line">                       __FILE__, __LINE__, <span class="stringliteral">&quot;reference&quot;</span>, 0,</div>
<div class="line">                       <a class="code" href="namespacesc.html#a7bb0ab68d220f5c48055177ef8b4e39b">class_desc</a>());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">MP2::MP2(<a class="code" href="classsc_1_1StateIn.html">StateIn</a> &amp;statein):<a class="code" href="classsc_1_1Wavefunction.html">Wavefunction</a>(statein)</div>
<div class="line">{</div>
<div class="line">  ref_mp2_wfn_ &lt;&lt; SavableState::restore_state(statein);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::save_data_state(<a class="code" href="classsc_1_1StateOut.html">StateOut</a> &amp;stateout) {</div>
<div class="line">  Wavefunction::save_data_state(stateout);</div>
<div class="line"> </div>
<div class="line">  SavableState::save_state(ref_mp2_wfn_.pointer(),stateout);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::compute(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(gradient_needed()) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;no gradients yet&quot;</span>,</div>
<div class="line">                                  __FILE__, __LINE__, <a class="code" href="namespacesc.html#a7bb0ab68d220f5c48055177ef8b4e39b">class_desc</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> extra_hf_acc = 10.;</div>
<div class="line">  ref_mp2_wfn_-&gt;set_desired_value_accuracy(desired_value_accuracy()</div>
<div class="line">                                           / extra_hf_acc);</div>
<div class="line">  <span class="keywordtype">double</span> refenergy = ref_mp2_wfn_-&gt;energy();</div>
<div class="line">  <span class="keywordtype">double</span> mp2energy = compute_mp2_energy();</div>
<div class="line"> </div>
<div class="line">  ExEnv::out0() &lt;&lt; indent &lt;&lt; <span class="stringliteral">&quot;MP2 Energy = &quot;</span> &lt;&lt; mp2energy &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">  set_value(refenergy + mp2energy);</div>
<div class="line">  set_actual_value_accuracy(ref_mp2_wfn_-&gt;actual_value_accuracy()</div>
<div class="line">                            * extra_hf_acc);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MP2::obsolete(<span class="keywordtype">void</span>) {</div>
<div class="line">  Wavefunction::obsolete();</div>
<div class="line">  ref_mp2_wfn_-&gt;obsolete();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">MP2::nelectron(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">return</span> ref_mp2_wfn_-&gt;nelectron();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a></div>
<div class="line">MP2::density(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;no density yet&quot;</span>,</div>
<div class="line">                              __FILE__, __LINE__, <a class="code" href="namespacesc.html#a7bb0ab68d220f5c48055177ef8b4e39b">class_desc</a>());</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span></div>
<div class="line">MP2::magnetic_moment()<span class="keyword"> const </span>{</div>
<div class="line">  <span class="keywordflow">return</span> 0.0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">MP2::value_implemented(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{</div>
<div class="line">  <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span></div>
<div class="line">MP2::compute_mp2_energy()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span>(molecule()-&gt;point_group()-&gt;char_table().order() != 1) {</div>
<div class="line">      <span class="keywordflow">throw</span> <a class="code" href="classsc_1_1FeatureNotImplemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;C1 symmetry only&quot;</span>,</div>
<div class="line">                                  __FILE__, __LINE__, <a class="code" href="namespacesc.html#a7bb0ab68d220f5c48055177ef8b4e39b">class_desc</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSCMatrix.html">RefSCMatrix</a> vec = ref_mp2_wfn_-&gt;eigenvectors();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nao = vec.nrow();</div>
<div class="line">  <span class="keywordtype">int</span> nmo = vec.ncol();</div>
<div class="line">  <span class="keywordtype">int</span> nocc = ref_mp2_wfn_-&gt;nelectron()/2;</div>
<div class="line">  <span class="keywordtype">int</span> nvir = nmo - nocc;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> cvec_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [vec.nrow() * vec.ncol()]);</div>
<div class="line">  <span class="keywordtype">double</span> *cvec = cvec_av.<a class="code" href="classsc_1_1auto__vec.html#a62169bed4c236e8b02804bdf5f0232f8">get</a>();</div>
<div class="line">  vec-&gt;convert(cvec);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> pqrs_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nao * nao * nao * nao]);</div>
<div class="line">  <span class="keywordtype">double</span> *pqrs = pqrs_av.get();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt; nao*nao*nao*nao; n++) pqrs[n] = 0.0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;TwoBodyInt&gt;</a> twoint = integral()-&gt;electron_repulsion();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> *buffer = twoint-&gt;<a class="code" href="classsc_1_1TwoBodyInt.html#a6f5897ccb457d2ba3b80387d65441022">buffer</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;GaussianBasisSet&gt;</a> basis = this-&gt;basis();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nshell = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a5533ca3d1888dd66ca7f0e47ab3452a9">nshell</a>();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> P = 0; P &lt; nshell; P++) {</div>
<div class="line">    <span class="keywordtype">int</span> nump = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#aa122e5263aca50058b3651aec9f298e1">shell</a>(P).<a class="code" href="classsc_1_1GaussianShell.html#afb37df6ba9eddc41731a80667f302c01">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Q = 0; Q &lt; nshell; Q++) {</div>
<div class="line">      <span class="keywordtype">int</span> numq = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#aa122e5263aca50058b3651aec9f298e1">shell</a>(Q).<a class="code" href="classsc_1_1GaussianShell.html#afb37df6ba9eddc41731a80667f302c01">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> R = 0; R &lt; nshell; R++) {</div>
<div class="line">    <span class="keywordtype">int</span> numr = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#aa122e5263aca50058b3651aec9f298e1">shell</a>(R).<a class="code" href="classsc_1_1GaussianShell.html#afb37df6ba9eddc41731a80667f302c01">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> S = 0; S &lt; nshell; S++) {</div>
<div class="line">      <span class="keywordtype">int</span> nums = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#aa122e5263aca50058b3651aec9f298e1">shell</a>(S).<a class="code" href="classsc_1_1GaussianShell.html#afb37df6ba9eddc41731a80667f302c01">nfunction</a>();</div>
<div class="line"> </div>
<div class="line">      twoint-&gt;<a class="code" href="classsc_1_1TwoBodyInt.html#a8d1110a67d7886e6251a5d8158f603ed">compute_shell</a>(P,Q,R,S);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">int</span> index = 0;</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0; p &lt; nump; p++) {</div>
<div class="line">        <span class="keywordtype">int</span> op = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(P)+p;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> q = 0; q &lt; numq; q++) {</div>
<div class="line">          <span class="keywordtype">int</span> oq = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(Q)+q;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 0; r &lt; numr; r++) {</div>
<div class="line">        <span class="keywordtype">int</span> oor = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(R)+r;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s = 0; s &lt; nums; s++,index++) {</div>
<div class="line">          <span class="keywordtype">int</span> os = basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">shell_to_function</a>(S)+s;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> ipqrs = (((op*nao+oq)*nao+oor)*nao+os);</div>
<div class="line"> </div>
<div class="line">          pqrs[ipqrs] = buffer[index];</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  twoint = 0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> ijkl_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nmo * nmo * nmo * nmo]);</div>
<div class="line">  <span class="keywordtype">double</span> *ijkl = ijkl_av.get();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nmo; i++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nmo; j++) {</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; nmo; k++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; nmo; l++, idx++) {</div>
<div class="line"> </div>
<div class="line">      ijkl[idx] = 0.0;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">int</span> index = 0;</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p = 0; p &lt; nao; p++) {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> q = 0; q &lt; nao; q++) {</div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 0; r &lt; nao; r++) {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s = 0; s &lt; nao; s++,index++) {</div>
<div class="line"> </div>
<div class="line">          ijkl[idx] += cvec[p*nmo + i] * cvec[q*nmo +j]</div>
<div class="line">            * cvec[r*nmo + k] * cvec[s*nmo + l]</div>
<div class="line">            * pqrs[index];</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  pqrs_av.<a class="code" href="classsc_1_1auto__vec.html#a9d3ab9d6be3bdebbdc198f0aeac59e12">release</a>(); pqrs = 0;</div>
<div class="line">  cvec_av.release(); cvec = 0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1auto__vec.html">auto_vec&lt;double&gt;</a> evals_av(<span class="keyword">new</span> <span class="keywordtype">double</span> [nmo]);</div>
<div class="line">  <span class="keywordtype">double</span> *evals = evals_av.get();</div>
<div class="line">  ref_mp2_wfn_-&gt;eigenvalues()-&gt;convert(evals);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> energy = 0.0;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; nocc; i++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt; nocc; j++) {</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a=nocc; a &lt; nmo; a++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=nocc; b &lt; nmo; b++) {</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">int</span> iajb = (((i*nmo+a)*nmo+j)*nmo+b);</div>
<div class="line">      <span class="keywordtype">int</span> ibja = (((i*nmo+b)*nmo+j)*nmo+a);</div>
<div class="line"> </div>
<div class="line">      energy += (2 * ijkl[iajb] - ijkl[ibja]) * ijkl[iajb]/</div>
<div class="line">        (evals[i] + evals[j] - evals[a] - evals[b]);</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ijkl_av.release(); ijkl = 0;</div>
<div class="line">  evals_av.release(); evals = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> energy;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="devsampmp2mak"></a>
MP2 Implementation Example: Makefile</h2>
<p>This example Makefile demonstrates how to link in a new class to form a new mpqc executable, here named mp2. The code is given in the <a class="el" href="develop.html#devsampmp2src">MP2 Implementation Example: Source</a> section. The <a class="el" href="develop.html#mpqc-config">mpqc-config command</a> is used to obtain information about how the MPQC toolkit was compiled and installed. The library specified with -lmpqc provides the main routine from mpqc.</p>
<div class="fragment"><div class="line"># Change this to the (absolute) path to your installed mpqc-config script, if needed</div>
<div class="line">MPQCCONFIG = ../../../../../bin/mpqc-config</div>
<div class="line">CXX := $(shell $(MPQCCONFIG) --cxx)</div>
<div class="line">CXXFLAGS := $(shell $(MPQCCONFIG) --cxxflags)</div>
<div class="line">CC := $(shell $(MPQCCONFIG) --cc)</div>
<div class="line">CCFLAGS := $(shell $(MPQCCONFIG) --cflags)</div>
<div class="line">F77 := $(shell $(MPQCCONFIG) --f77)</div>
<div class="line">F90 := $(F77)</div>
<div class="line">FFLAGS := $(shell $(MPQCCONFIG) --f77flags)</div>
<div class="line">F90FLAGS := $(FFLAGS)</div>
<div class="line">CPPFLAGS := $(shell $(MPQCCONFIG) --cppflags)</div>
<div class="line">LIBS := $(shell $(MPQCCONFIG) --libs)</div>
<div class="line">LIBDIR  := $(shell $(MPQCCONFIG) --libdir)</div>
<div class="line">LDFLAGS := $(shell $(MPQCCONFIG) --ldflags)</div>
<div class="line"> </div>
<div class="line">TARGET = mp2</div>
<div class="line"> </div>
<div class="line">$(TARGET): $(TARGET).o</div>
<div class="line">    $(CXX) $(CXXFLAGS) -o $@ $^ -L$(LIBDIR) $(LDFLAGS) -lmpqcmain $(LIBS)</div>
<div class="line"> </div>
<div class="line">clean:</div>
<div class="line">    -rm -f $(TARGET) $(TARGET).o</div>
</div><!-- fragment --><h2><a class="anchor" id="devsampmp2inp"></a>
MP2 Implementation Example: Input</h2>
<p>This input file can be used with the program illustrated in the <a class="el" href="develop.html#devsampmp2src">MP2 Implementation Example: Source</a> section. It will compute the MP2 energy using the new MP2 class. Note that only the <a class="el" href="mpqcoo.html">object-oriented input format</a> can be used with user provided classes.</p>
<div class="fragment"><div class="line">% emacs should use -*- KeyVal -*- mode</div>
<div class="line">molecule&lt;Molecule&gt;: (</div>
<div class="line">  symmetry = C1</div>
<div class="line">  unit = angstrom</div>
<div class="line">  { atoms geometry } = {</div>
<div class="line">    O     [     0.00000000     0.00000000     0.37000000 ]</div>
<div class="line">    H     [     0.78000000     0.00000000    -0.18000000 ]</div>
<div class="line">    H     [    -0.78000000     0.00000000    -0.18000000 ]</div>
<div class="line">  }</div>
<div class="line">)</div>
<div class="line">basis&lt;GaussianBasisSet&gt;: (</div>
<div class="line">  name = &quot;STO-3G&quot;</div>
<div class="line">  molecule = $:molecule</div>
<div class="line">)</div>
<div class="line">mpqc: (</div>
<div class="line">  checkpoint = no</div>
<div class="line">  savestate = no</div>
<div class="line">  % MP2 is the new class.  Change MP2 to MBPT2 to test</div>
<div class="line">  % against the standard MP2 code</div>
<div class="line">  mole&lt;MP2&gt;: (</div>
<div class="line">    molecule = $:molecule</div>
<div class="line">    basis = $:basis</div>
<div class="line">    reference&lt;CLHF&gt;: (</div>
<div class="line">      molecule = $:molecule</div>
<div class="line">      basis = $:basis</div>
<div class="line">      memory = 16000000</div>
<div class="line">    )</div>
<div class="line">  )</div>
<div class="line">)</div>
<div class="line"> </div>
</div><!-- fragment --><h1><a class="anchor" id="devsamphf"></a>
A user-provided main: HF Implementation Example</h1>
<p>The MP2 sample program above used the MPQC main routine. This does not always provide sufficient flexibility, and a user-provide main routine is sometimes more appropriate. However, quite a few steps are need to prepare for a run, most of which have to do with initializing various libraries to prepare for a parallel run. The HF example illustrates how an <a class="el" href="classsc_1_1MPQCInit.html" title="This helper class simplifies initialization of MPQC.">sc::MPQCInit</a> object can be used to prepare for a computation. It implements a complete closed-shell Hartree-Fock program using various MPQC functionality, without provide a new MPQC <a class="el" href="classsc_1_1Wavefunction.html" title="A Wavefunction is a MolecularEnergy that utilizies a GaussianBasisSet.">sc::Wavefunction</a> implementation as done in the previous example (<a class="el" href="develop.html#devsampmp2">Using MPQC's main: MP2 Implementation Example</a>).</p>
<p>This example program can be found in the <code>doc/devsamp/hf</code> subdirectory of the MPQC source distribution and is shown here in its entirety.</p>
<h1><a class="anchor" id="devsamphfsrc"></a>
HF Implementation Example: Source Code</h1>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/molecule/molecule.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/basis/integral.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/basis/symmint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/basis/orthog.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/intv3/intv3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/lcao/fockbuild.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/lcao/fockdist.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chemistry/qc/lcao/clhfcontrib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math/optimize/scextrap.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math/optimize/diis.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math/optimize/scextrapmat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/group/mstate.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/group/pregtime.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/group/memory.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;util/group/thread.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;exception&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;mpqcinit.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacesc.html">sc</a>;</div>
<div class="line"><span class="keyword">using</span> std::cout;</div>
<div class="line"><span class="keyword">using</span> std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">try_main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classsc_1_1GetLongOpt.html">GetLongOpt</a> opt;</div>
<div class="line">  opt.<a class="code" href="classsc_1_1GetLongOpt.html#ab6f63467e9083a5f6d57964416d07937">usage</a>(<span class="stringliteral">&quot;[options] [filename]&quot;</span>);</div>
<div class="line">  opt.<a class="code" href="classsc_1_1GetLongOpt.html#a7c39290a6bef4b177de45bcec741507b">enroll</a>(<span class="stringliteral">&quot;verbose&quot;</span>, GetLongOpt::NoValue, <span class="stringliteral">&quot;enable extra printing&quot;</span>, 0);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1MPQCInit.html">MPQCInit</a> init(opt,argc,argv);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> optind = opt.<a class="code" href="classsc_1_1GetLongOpt.html#a8327998237bf80c562e508cf2a3c1af6">parse</a>(argc, argv);</div>
<div class="line">  std::string inputfile;</div>
<div class="line">  <span class="keywordflow">if</span> (argc - optind == 0) {</div>
<div class="line">    inputfile = <span class="stringliteral">&quot;hf.in&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argc - optind == 1) {</div>
<div class="line">    inputfile = argv[optind];</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    opt.<a class="code" href="classsc_1_1GetLongOpt.html#ab6f63467e9083a5f6d57964416d07937">usage</a>(std::cout);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;sc::KeyVal&gt;</a> keyval = init.init(inputfile);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;sc::ThreadGrp&gt;</a> thr = <a class="code" href="classsc_1_1ThreadGrp.html#aac2daff43f786e3f61ecf6dab16b9874">sc::ThreadGrp::get_default_threadgrp</a>();</div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;sc::MessageGrp&gt;</a> msg = <a class="code" href="classsc_1_1MessageGrp.html#a8c72153c6212fa3692cc30abfef063dc">sc::MessageGrp::get_default_messagegrp</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (opt.<a class="code" href="classsc_1_1GetLongOpt.html#ab02cef4780e920d0af619a57d993e6c4">retrieve</a>(<span class="stringliteral">&quot;verbose&quot;</span>)) {</div>
<div class="line">    <a class="code" href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">sc::ExEnv::out0</a>() &lt;&lt; indent</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;nthread = &quot;</span> &lt;&lt; thr-&gt;<a class="code" href="classsc_1_1ThreadGrp.html#a42b09fadf5257e460722b8dc50abb985">nthread</a>() &lt;&lt; std::endl;</div>
<div class="line">    <a class="code" href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">sc::ExEnv::out0</a>() &lt;&lt; indent</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;nnode   = &quot;</span> &lt;&lt; msg-&gt;<a class="code" href="classsc_1_1MessageGrp.html#a9f088f8934d788db2e9f1e724cd66b13">n</a>() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;GaussianBasisSet&gt;</a> basis;</div>
<div class="line">  basis &lt;&lt; keyval-&gt;<a class="code" href="classsc_1_1KeyVal.html#a1a53bd0f1706a9a54fd9d898a610ab51">describedclassvalue</a>(<span class="stringliteral">&quot;basis&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// make an integral factory and get the petite list</span></div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;Integral&gt;</a> integral = <span class="keyword">new</span> <a class="code" href="classsc_1_1IntegralV3.html">IntegralV3</a>(basis);</div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;PetiteList&gt;</a> pl = integral-&gt;<a class="code" href="classsc_1_1Integral.html#a30f74e5b0aa850c7b44384d94b7b9fa3">petite_list</a>();</div>
<div class="line">  integral-&gt;<a class="code" href="classsc_1_1Integral.html#a50f4c1446a85092683d05e072237fefe">set_storage</a>(32000000);</div>
<div class="line">  <a class="code" href="classsc_1_1Integral.html#ab1ccff8d6f1b4b237eed4c153b44339c">Integral::set_default_integral</a>(integral);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// construct the overlap matrix, s</span></div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> s_skel(basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a2c8cc56d931c84679711db74facfcdff">basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#ad8da790554ea38b47a1854145e0fedc9">matrixkit</a>());</div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;SCElementOp&gt;</a> s_op</div>
<div class="line">      = <span class="keyword">new</span> <a class="code" href="classsc_1_1OneBodyIntOp.html">OneBodyIntOp</a>(<span class="keyword">new</span> <a class="code" href="classsc_1_1SymmOneBodyIntIter.html">SymmOneBodyIntIter</a>(integral-&gt;<a class="code" href="classsc_1_1Integral.html#a492e86b39ea36402e14876813ade570c">overlap</a>(), pl));</div>
<div class="line"> </div>
<div class="line">  s_skel.assign(0.0);</div>
<div class="line">  s_skel.element_op(s_op);</div>
<div class="line">  s_op=0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> s_SO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  pl-&gt;symmetrize(s_skel,s_SO);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// construct the basis set orthogonalizer</span></div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;OverlapOrthog&gt;</a> orthog</div>
<div class="line">      = <span class="keyword">new</span> <a class="code" href="classsc_1_1OverlapOrthog.html">OverlapOrthog</a>(OverlapOrthog::Symmetric,</div>
<div class="line">                          s_SO,</div>
<div class="line">                          basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>(),</div>
<div class="line">                          1.0e-6 <span class="comment">/*lindep tolerance*/</span>,</div>
<div class="line">                          0 <span class="comment">/* debug */</span></div>
<div class="line">          );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// construct the core hamiltonian (nuclear attraction + kinetic energy)</span></div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> hcore_skel(basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a2c8cc56d931c84679711db74facfcdff">basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#ad8da790554ea38b47a1854145e0fedc9">matrixkit</a>());</div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;SCElementOp&gt;</a> hcore_op</div>
<div class="line">      = <span class="keyword">new</span> <a class="code" href="classsc_1_1OneBodyIntOp.html">OneBodyIntOp</a>(<span class="keyword">new</span> <a class="code" href="classsc_1_1SymmOneBodyIntIter.html">SymmOneBodyIntIter</a>(integral-&gt;<a class="code" href="classsc_1_1Integral.html#a1b880e24e832144e16cc67fbc3ccd579">hcore</a>(), pl));</div>
<div class="line"> </div>
<div class="line">  hcore_skel.assign(0.0);</div>
<div class="line">  hcore_skel.element_op(hcore_op);</div>
<div class="line">  hcore_op=0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> hcore_SO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  pl-&gt;symmetrize(hcore_skel,hcore_SO);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> density_AO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ad90d6fbe8ff541e05a5b4820b7dfccd3">AO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  density_AO.assign(0.0);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSCMatrix.html">RefSCMatrix</a> vector_OSO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), orthog-&gt;orthog_dim(),</div>
<div class="line">                         basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  vector_OSO.assign(0.0);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefDiagSCMatrix.html">RefDiagSCMatrix</a> evals(orthog-&gt;orthog_dim(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> density_SO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classsc_1_1Ref.html">Ref&lt;SelfConsistentExtrapolation&gt;</a> extrap = <span class="keyword">new</span> <a class="code" href="classsc_1_1DIIS.html">DIIS</a>;</div>
<div class="line">  extrap-&gt;set_tolerance(1.0e-6);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// read the occupation numbers</span></div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> occ(orthog-&gt;orthog_dim(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  occ.assign(0.0);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;orthog-&gt;orthog_dim(); i++) {</div>
<div class="line">      occ(i,i) = keyval-&gt;<a class="code" href="classsc_1_1KeyVal.html#af3636a9ab8bf041efe790791a54bb254">doublevalue</a>(<span class="stringliteral">&quot;occ&quot;</span>,i);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// construct the initial guess to vector_OSO and density_AO</span></div>
<div class="line">  <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> hcore_OSO(orthog-&gt;orthog_dim(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">  hcore_OSO.assign(0.0);</div>
<div class="line">  hcore_OSO.accumulate_transform(orthog-&gt;<a class="code" href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">basis_to_orthog_basis</a>(),hcore_SO);</div>
<div class="line">  hcore_OSO.diagonalize(evals, vector_OSO);</div>
<div class="line"> </div>
<div class="line">  density_SO.assign(0.0);</div>
<div class="line">  <a class="code" href="classsc_1_1RefSCMatrix.html">RefSCMatrix</a> vector_SO = orthog-&gt;<a class="code" href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">basis_to_orthog_basis</a>().<a class="code" href="classsc_1_1RefSCMatrix.html#a78670ab26d5b9757ae8114e1036345ea">t</a>() * vector_OSO;</div>
<div class="line">  density_SO.accumulate_transform(vector_SO, occ);</div>
<div class="line">  density_AO = pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#a34b548a02418052530924b3ee7f76fe5">to_AO_basis</a>(density_SO);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (!extrap-&gt;converged()) {</div>
<div class="line">      <span class="comment">//while (!extrap-&gt;converged()) {</span></div>
<div class="line">      <span class="comment">// construct the G matrix</span></div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> g_skel(basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a2c8cc56d931c84679711db74facfcdff">basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#ad8da790554ea38b47a1854145e0fedc9">matrixkit</a>());</div>
<div class="line">      g_skel.assign(0.0);</div>
<div class="line">      <a class="code" href="classsc_1_1Ref.html">Ref&lt;FockContribution&gt;</a> g_contrib</div>
<div class="line">          = <span class="keyword">new</span> <a class="code" href="classsc_1_1CLHFContribution.html">CLHFContribution</a>(basis,basis,basis,<span class="stringliteral">&quot;replicated&quot;</span>);</div>
<div class="line">      g_contrib-&gt;set_fmat(0, g_skel);</div>
<div class="line">      g_contrib-&gt;set_pmat(0, density_AO);</div>
<div class="line">      <a class="code" href="classsc_1_1Ref.html">Ref&lt;FockDistribution&gt;</a> fockdist = <span class="keyword">new</span> <a class="code" href="classsc_1_1FockDistribution.html">FockDistribution</a>;</div>
<div class="line">      <a class="code" href="classsc_1_1Ref.html">Ref&lt;FockBuild&gt;</a> fb = <span class="keyword">new</span> <a class="code" href="classsc_1_1FockBuild.html">FockBuild</a>(fockdist, g_contrib, <span class="keyword">false</span>,</div>
<div class="line">                                        basis, basis, basis);</div>
<div class="line">      fb-&gt;set_accuracy(1e-12);</div>
<div class="line">      fb-&gt;<a class="code" href="classsc_1_1FockBuild.html#a6302c16dc00cfde7ced673d3bcdf0473">build</a>();</div>
<div class="line">  </div>
<div class="line">      g_skel.scale(1.0/(<span class="keywordtype">double</span>)pl-&gt;order());</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> g_SO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">      pl-&gt;symmetrize(g_skel,g_SO);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// compute the exchange/correlation potential</span></div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> vxc_SO;</div>
<div class="line">      <span class="keywordtype">double</span> exc = 0.0;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// construct the fock matrix</span></div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> f_SO = hcore_SO + g_SO;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// transform the fock matrix into the orthogonal basis</span></div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> f_OSO(orthog-&gt;orthog_dim(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">      f_OSO.assign(0.0);</div>
<div class="line">      f_OSO.accumulate_transform(orthog-&gt;<a class="code" href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">basis_to_orthog_basis</a>(),f_SO);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Extrapolate the fock matrix</span></div>
<div class="line">      <a class="code" href="classsc_1_1Ref.html">Ref&lt;SCExtrapData&gt;</a> data = <span class="keyword">new</span> <a class="code" href="classsc_1_1SymmSCMatrixSCExtrapData.html">SymmSCMatrixSCExtrapData</a>(f_OSO);</div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> error_MO(orthog-&gt;orthog_dim(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">      error_MO.assign(0.0);</div>
<div class="line">      error_MO.accumulate_transform(vector_OSO.t(),f_OSO);</div>
<div class="line">      error_MO-&gt;scale_diagonal(0.0);</div>
<div class="line">  </div>
<div class="line">      <a class="code" href="classsc_1_1RefSymmSCMatrix.html">RefSymmSCMatrix</a> error_SO(pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">SO_basisdim</a>(), basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">so_matrixkit</a>());</div>
<div class="line">      error_SO.assign(0.0);</div>
<div class="line">      error_SO.accumulate_transform(orthog-&gt;<a class="code" href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">basis_to_orthog_basis</a>().<a class="code" href="classsc_1_1RefSCMatrix.html#a78670ab26d5b9757ae8114e1036345ea">t</a>()</div>
<div class="line">                                    *vector_OSO, error_MO);</div>
<div class="line">      <a class="code" href="classsc_1_1Ref.html">Ref&lt;SCExtrapError&gt;</a> error = <span class="keyword">new</span> <a class="code" href="classsc_1_1SymmSCMatrixSCExtrapError.html">SymmSCMatrixSCExtrapError</a>(error_SO);</div>
<div class="line">      extrap-&gt;extrapolate(data,error);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Diagonalize the fock matrix</span></div>
<div class="line">      f_OSO.diagonalize(evals, vector_OSO);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Compute the density matrix</span></div>
<div class="line">      density_SO.assign(0.0);</div>
<div class="line">      vector_SO = orthog-&gt;<a class="code" href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">basis_to_orthog_basis</a>().<a class="code" href="classsc_1_1RefSCMatrix.html#a78670ab26d5b9757ae8114e1036345ea">t</a>() * vector_OSO;</div>
<div class="line">      density_SO.accumulate_transform(vector_SO, occ);</div>
<div class="line">      density_AO = pl-&gt;<a class="code" href="classsc_1_1PetiteList.html#a34b548a02418052530924b3ee7f76fe5">to_AO_basis</a>(density_SO);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> energy =exc + basis-&gt;<a class="code" href="classsc_1_1GaussianBasisSet.html#ae4989230715b4cda787d3d781e7db1de">molecule</a>()-&gt;nuclear_repulsion_energy()</div>
<div class="line">                     +(density_SO * 0.5 * (hcore_SO + f_SO)).trace();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">ExEnv::out0</a>() &lt;&lt; indent</div>
<div class="line">                    &lt;&lt; <a class="code" href="classsc_1_1scprintf.html">scprintf</a>(<span class="stringliteral">&quot;energy = %14.8f, error = %10.8f&quot;</span>,</div>
<div class="line">                                energy, extrap-&gt;error()) &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">      try_main(argc, argv);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::bad_alloc &amp;e) {</div>
<div class="line">      cout &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot;: ERROR: MEMORY ALLOCATION FAILED:&quot;</span> &lt;&lt; endl</div>
<div class="line">           &lt;&lt; e.what()</div>
<div class="line">           &lt;&lt; endl;</div>
<div class="line">      exit(1);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line">      cout &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot;: ERROR: EXCEPTION RAISED:&quot;</span> &lt;&lt; endl</div>
<div class="line">           &lt;&lt; e.what()</div>
<div class="line">           &lt;&lt; endl;</div>
<div class="line">      exit(1);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...) {</div>
<div class="line">      cout &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot;: ERROR: UNKNOWN EXCEPTION RAISED&quot;</span> &lt;&lt; endl;</div>
<div class="line">      exit(1);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="devsamphfmak"></a>
HF Implementation Example: Makefile</h2>
<p>This example Makefile will build an executable named hf. The <a class="el" href="develop.html#mpqc-config">mpqc-config command</a> is used to obtain information about how the MPQC toolkit was compiled and installed. The library specified with -lmpqcinit provides the initialization routines from mpqc.</p>
<div class="fragment"><div class="line"># Change this to the (absolute) path to your installed mpqc-config script, if needed</div>
<div class="line">MPQCCONFIG = ../../../../../bin/mpqc-config</div>
<div class="line">CXX := $(shell $(MPQCCONFIG) --cxx)</div>
<div class="line">CXXFLAGS := $(shell $(MPQCCONFIG) --cxxflags)</div>
<div class="line">CC := $(shell $(MPQCCONFIG) --cc)</div>
<div class="line">CCFLAGS := $(shell $(MPQCCONFIG) --cflags)</div>
<div class="line">F77 := $(shell $(MPQCCONFIG) --f77)</div>
<div class="line">F90 := $(F77)</div>
<div class="line">FFLAGS := $(shell $(MPQCCONFIG) --f77flags)</div>
<div class="line">F90FLAGS := $(FFLAGS)</div>
<div class="line">CPPFLAGS := $(shell $(MPQCCONFIG) --cppflags)</div>
<div class="line">LIBS := $(shell $(MPQCCONFIG) --libs)</div>
<div class="line">LIBDIR  := $(shell $(MPQCCONFIG) --libdir)</div>
<div class="line">LDFLAGS := $(shell $(MPQCCONFIG) --ldflags)</div>
<div class="line"> </div>
<div class="line">TARGET = hf</div>
<div class="line"> </div>
<div class="line">$(TARGET): $(TARGET).o</div>
<div class="line">    $(CXX) $(CXXFLAGS) -o $@ $^ -L$(LIBDIR) $(LDFLAGS) $(LIBS)</div>
<div class="line"> </div>
<div class="line">clean:</div>
<div class="line">    -rm -f $(TARGET) $(TARGET).o</div>
</div><!-- fragment --><h2><a class="anchor" id="devsamphfinp"></a>
HF Implementation Example: Input</h2>
<p>This input will run a Hartree-Fock calculation on a water molecule. The section beginning <code>mpqc:</code> provides the input needed to run the <code>mpqc</code> program with the same basis set and geometry as a check. The <code>hf</code> program only reads the <code>occ</code> and <code>basis</code> keywords at the beginning of the sample input.</p>
<div class="fragment"><div class="line"> </div>
<div class="line">% occupation vector elements must be 0 or 2</div>
<div class="line">occ = [ 2 2 2 2 2 ]</div>
<div class="line"> </div>
<div class="line">basis&lt;GaussianBasisSet&gt;: (</div>
<div class="line">  name = &quot;STO-3G&quot;</div>
<div class="line">  puream = 0</div>
<div class="line">  molecule&lt;Molecule&gt;: (</div>
<div class="line">      symmetry = c1</div>
<div class="line">      { atoms geometry } = {</div>
<div class="line">         O    [ 0 0 0 ]</div>
<div class="line">         H    [ 0 -1 1]</div>
<div class="line">         H    [ 0  1 1]</div>
<div class="line">      }</div>
<div class="line">  )</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">% This is not needed by the hf.cc example. It is here to allow this</div>
<div class="line">% input file to be used with MPQC for testing purposes.</div>
<div class="line">mpqc: (</div>
<div class="line">  mole&lt;CLHF&gt;: (</div>
<div class="line">    molecule = $:basis:molecule</div>
<div class="line">    basis = $:basis</div>
<div class="line">    density_reset_frequency = 1</div>
<div class="line">    guess_wavefunction&lt;HCoreWfn&gt;: (</div>
<div class="line">      molecule = $:basis:molecule</div>
<div class="line">      basis = $:basis</div>
<div class="line">    )</div>
<div class="line">  )</div>
<div class="line">)</div>
</div><!-- fragment --><h1><a class="anchor" id="scexcept"></a>
Exception Handling in MPQC</h1>
<p>The development of MPQC began before exception handling was available in C++. A retrofit of the code to use exceptions is in progress. It is difficult to retrofit a code, especially a parallel code, to do exception handling. There will be some limitations: exception handling will not work well for parallel jobs, objects whose members throw might be left in a questionable state, etc. However, it is intended that MPQC objects will be usable in an interactive environment. It is also planned that exceptions be used internally to facilitate recover from certain problems.</p>
<p>All new code should use exceptions instead of exit or abort and allocate resources in such a way that, if an exception occurs, all resources such as memory or locks are released. A hierarchy of exception classes has been created that maps better to scientific computing than the standard exceptions. More information is below, as well as in the documentation for the SCException class and its derivatives.</p>
<ul>
<li>
<a class="el" href="develop.html#scexceptmem">Exceptions and Memory Allocation</a> </li>
<li>
<a class="el" href="develop.html#scexceptlocks">Exceptions and Locks</a> </li>
<li>
<a class="el" href="develop.html#scexcepttimer">Exceptions and Region Timers</a> </li>
<li>
<a class="el" href="develop.html#scexceptexample">Using the MPQC Exception Classes</a> </li>
<li>
<a class="el" href="develop.html#scexceptdebug">Debugging Code with Exceptions</a> </li>
</ul>
<h2><a class="anchor" id="scexceptmem"></a>
Exceptions and Memory Allocation</h2>
<p>Consider the following code fragment:</p>
<pre>
Object *obj = new Object;
double *array = new double[n];</pre><pre>f(obj, array, mol);</pre><pre>delete obj;
delete[] array;
</pre><p>If an exception is thrown in the function f(), then storage for array and obj will not be released. The standard C++ library provides a class, auto_ptr, to deal with obj, and the MPQC toolkit provides a class, auto_vec, to deal with array.</p>
<p>The include files for these two classes are:</p>
<pre>
#include &lt;memory&gt;
#include &lt;<a class="el" href="autovec_8h_source.html">util/misc/autovec.h</a>&gt;
</pre><p>the code would be modified as follows:</p>
<pre>
std::auto_ptr&lt;Object&gt; obj(new Object);
sc::auto_vec&lt;double&gt; array(new double[n]);</pre><pre>f(obj.get(), array.get());</pre><pre>obj.release();  // or just let the destructor release it
array.release();  // or just let the destructor release it
</pre><p>Note that when <a class="el" href="classsc_1_1Ref.html" title="A template class that maintains references counts.">sc::Ref</a> is used to store pointers, the storage will automatically be released when necessary. No special treatment is needed to deal with exceptions.</p>
<h2><a class="anchor" id="scexceptlocks"></a>
Exceptions and Locks</h2>
<p>Consider the following code fragment:</p>
<pre>
g(const sc::Ref&lt;sc::ThreadLock&gt; &amp;lock)
{
  lock-&gt;lock();
  f();
  lock-&gt;unlock();
}
</pre><p>If f() throws, then the lock is never released. The ThreadLock lock() and unlock() members should not be used anymore. Now do the following:</p>
<pre>
g(const sc::Ref&lt;sc::ThreadLock&gt; &amp;lock)
{
  <a class="el" href="classsc_1_1ThreadLockHolder.html" title="Acquire a lock on creation and release it on destruction.">sc::ThreadLockHolder</a> lockholder(lock);
  f();
  lockholder-&gt;unlock(); // or let the destructor unlock it
}
</pre><h2><a class="anchor" id="scexcepttimer"></a>
Exceptions and Region Timers</h2>
<p>Consider the following code fragment:</p>
<pre>
g(const sc::Ref&lt;sc::RegionTimer&gt; &amp;regtim)
{
  regtim-&gt;enter("f()");
  f();
  regtim-&gt;exit();
}
</pre><p>If f() throws, then the "f()" timing region is never exited. Instead use the following:</p>
<pre>
g(const sc::Ref&lt;sc::RegionTimer&gt; &amp;regtim)
{
  <a class="el" href="classsc_1_1Timer.html" title="The Timer class uses RegionTimer to time intervals in an exception safe manner.">sc::Timer</a> timer(regtim, "f()");
  f();
  timer.reset(); // or let the destructor exit the region
}
</pre><h2><a class="anchor" id="scexceptexample"></a>
Using the MPQC Exception Classes</h2>
<p>The MPQC exceptions provide information that can be used into two ways. First, text information is provided so that if the exception is not caught at a lower level, then the mpqc executable will catch it and write information about the problem to the terminal or an output file. Second, information about the nature of the problem is provided, to permit developers to catch the exception and deal with it in some way. The documentation for <a class="el" href="classsc_1_1SCException.html" title="This is a sc::Exception specialization that keeps track of the ClassDesc for the MPQC object from whi...">sc::SCException</a> and all of its derivatives gives more information about the exceptions that are available. As an example, consider the following loop, where a maximum number of iterations is permitted:</p>
<pre>
XYZ::update()
{
  for (int i=0; i&lt;maxiter; i++) {
    // ... compute xyz update ...
    if (residual &lt; threshold) return;
  }
  throw MaxIterExceeded("too many iterations xyz computation",
                        __FILE__, __LINE__, maxiter, class_desc());
}
</pre><p>The first argument to the exception class is a brief description of the error. Additional information can be provided, see SCException::elaborate() description below. The next two arguments are the filename and line number. The C preprocessor provides these for you with the <b>FILE</b> and <b>LINE</b> macros. The next argument is specific to the MaxIterExceeded exception; it is the maximum number of iterations. Finally, a ClassDesc* can be given, which will be used to print out the class name of the object that failed. All of these arguments are optional; however, the first three should always be given.</p>
<p>It is possible to provide additional information using the SCException::elaborate() member. This will return a ostream, and the additional information can be written to this stream. However, if for some reason it is not possible to write to this stream (say, there wasn't enough memory to allocate it), then an exception will be thrown. For this reason, the string description given as the first argument should be informative since the additional information might not be available, and attempts to use elaborate() should be in a try block. So, for example, the elaborate() member could be used in the above example as follows:</p>
<pre>
XYZ::update()
{
  for (int i=0; i&lt;maxiter; i++) {
    // ... compute xyz update ...
    if (residual &lt; threshold) return;
  }
  MaxIterExceeded ex("too many iterations in xyz computation",
                     __FILE__, __LINE__, maxiter, class_desc());
  try {
    ex.elaborate() &lt;&lt; "this can happen when the stepsize is too small"
                   &lt;&lt; std::endl
                   &lt;&lt; "the stepsize is " &lt;&lt; stepsize
                   &lt;&lt; std::endl;
  }
  catch (...) {}
  throw ex;
}
</pre><p>Note that writing to stream returned by elaborate() won't necessarily cause anything to get written to the terminal or an output file. The information will be available when the what() member is called, if writing to the stream succeeds. If the exception is caught by the mpqc main routine, then it will be printed for the user to see. If the program catches the exception and determines that it is possible to proceed in a different way, then the user will never see the text.</p>
<h2><a class="anchor" id="scexceptdebug"></a>
Debugging Code with Exceptions</h2>
<p>Usually, exceptions are not the desired behaviour in a program, and it is necessary to debug a program that throws an exception. This was easy when abort was called, because abort would raise a signal that was caught by the debugger and the code is stopped at the appropriate place. With exceptions the matter is more complex, because the stack is unwound when an exception is thrown and most debugging information is lost. To work around this problem, a breakpoint can be set in code that will be reached only in an exception, and will be run before the stack unwind begins. A useful place to do this when GCC is used as the compiler is in the routine __cxa_allocate_exception(). So, in gdb, the following could be done:</p>
<pre>
$ gdb ./scextest
(gdb) b main
(gdb) run
Breakpoint 1, main () at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:172
172           f();
(gdb) b __cxa_allocate_exception
(gdb) cont
Breakpoint 2, 0x40582d46 in __cxa_allocate_exception ()
   from /usr/lib/gcc-lib/i686-pc-linux-gnu/3.3.5/libstdc++.so.5
(gdb) where
#0  0x40582d46 in __cxa_allocate_exception ()
   from /usr/lib/gcc-lib/i686-pc-linux-gnu/3.3.5/libstdc++.so.5
#1  0x0804b3f7 in f () at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:60
#2  0x0804b9e9 in main ()
    at /home/cljanss/src/SC/src/lib/util/misc/scextest.cc:172
</pre><p>Giving gdb "b main" followed by "run" was required before gdb could find the __cxa_allocate_exception symbol.</p>
<h1><a class="anchor" id="devcheck"></a>
Adding Test Cases to the Verification Suite</h1>
<p>There are two ways to test an MPQC build. The <code>testbuild</code> and <code>testrun</code> make targets can be used to run test programs in various library directories, and the <code>check</code> and related make targets can be used to run MPQC on sets of input files. See <a class="el" href="mpqcval.html">Validating MPQC</a> for more information about how to run the tests.</p>
<p>Test programs can be added to the library directories by providing a source file with a main routine. The set of test programs that is to be built and run by <code>testbuild</code> and <code>testrun</code>, respectively, is given by the <code>TESTPROGS</code> variable in the library's <code>Makefile</code>. It may be necessary for an explicit rule to be given for building the test program to ensure that necessary libraries are linked in. If a file named after the test program with a <code>.out</code> suffix is found in the source directory, then <code>testrun</code> fail if the command's output differs from that file. Care must be taken to ensure that the output is architecture independent in this case. Otherwise, <code>testrun</code> will fail only if running the command results in a nonzero return code.</p>
<p>Additional MPQC test inputs can be added in the <code>test/ref</code> directory. These inputs can be provided in one of two ways. An input which is used to automatically generate multiple test cases can be written (with a <code>.qci</code> suffix), or a subdirectory with each input can be made. See <code>Makefile</code>, <code>basis1.qci</code>, and <code>input</code> in the <code>test/ref</code> directory for examples.</p>
<p>After you have added new inputs and modified the Makefile, change into the <code>test/ref</code> subdirectory of your object directory (where you compiled MPQC) and type <code>make inputs</code>. This will create a <code>input</code> subdirectory containing MPQC input files with a <code>.in</code> suffix. Files ending with a <code>.qci</code> suffix will also be placed in the <code>input</code> directory. These contain a description of the calculation that is used by the utility program that checks the results of the validation suite. Both the <code>.in</code> and <code>.qci</code> files for the new test cases must be copied into the <code>ref</code> directory in the source tree. Note that inputs that are not useful in your build environment are not created by <code>make inputs</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclasssc_1_1MessageGrp_html_a8c72153c6212fa3692cc30abfef063dc"><div class="ttname"><a href="classsc_1_1MessageGrp.html#a8c72153c6212fa3692cc30abfef063dc">sc::MessageGrp::get_default_messagegrp</a></div><div class="ttdeci">static MessageGrp * get_default_messagegrp()</div><div class="ttdoc">Returns the default message group.</div></div>
<div class="ttc" id="aclasssc_1_1PetiteList_html_ad90d6fbe8ff541e05a5b4820b7dfccd3"><div class="ttname"><a href="classsc_1_1PetiteList.html#ad90d6fbe8ff541e05a5b4820b7dfccd3">sc::PetiteList::AO_basisdim</a></div><div class="ttdeci">RefSCDimension AO_basisdim()</div><div class="ttdoc">blocked AO dimension (if symmetry = c1, equivalent to SO_basisdim(); otherwise number of blocks = 1,...</div></div>
<div class="ttc" id="aclasssc_1_1MPQCInit_html"><div class="ttname"><a href="classsc_1_1MPQCInit.html">sc::MPQCInit</a></div><div class="ttdoc">This helper class simplifies initialization of MPQC.</div><div class="ttdef"><b>Definition:</b> mpqcinit.h:21</div></div>
<div class="ttc" id="aclasssc_1_1GetLongOpt_html_a7c39290a6bef4b177de45bcec741507b"><div class="ttname"><a href="classsc_1_1GetLongOpt.html#a7c39290a6bef4b177de45bcec741507b">sc::GetLongOpt::enroll</a></div><div class="ttdeci">int enroll(const char *const opt, const OptType t, const char *const desc, const char *const val)</div><div class="ttdoc">Enroll an option.</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html_a9d3ab9d6be3bdebbdc198f0aeac59e12"><div class="ttname"><a href="classsc_1_1auto__vec.html#a9d3ab9d6be3bdebbdc198f0aeac59e12">sc::auto_vec::release</a></div><div class="ttdeci">T * release() MPQC__NOEXCEPT</div><div class="ttdoc">Release ownership.</div><div class="ttdef"><b>Definition:</b> autovec.h:91</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html_a62169bed4c236e8b02804bdf5f0232f8"><div class="ttname"><a href="classsc_1_1auto__vec.html#a62169bed4c236e8b02804bdf5f0232f8">sc::auto_vec::get</a></div><div class="ttdeci">T * get() const MPQC__NOEXCEPT</div><div class="ttdoc">Returns the pointer.</div><div class="ttdef"><b>Definition:</b> autovec.h:82</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a5533ca3d1888dd66ca7f0e47ab3452a9"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a5533ca3d1888dd66ca7f0e47ab3452a9">sc::GaussianBasisSet::nshell</a></div><div class="ttdeci">unsigned int nshell() const</div><div class="ttdoc">Return the number of shells.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:500</div></div>
<div class="ttc" id="aclasssc_1_1RefSymmSCMatrix_html"><div class="ttname"><a href="classsc_1_1RefSymmSCMatrix.html">sc::RefSymmSCMatrix</a></div><div class="ttdoc">The RefSymmSCMatrix class is a smart pointer to an SCSymmSCMatrix specialization.</div><div class="ttdef"><b>Definition:</b> matrix.h:265</div></div>
<div class="ttc" id="aclasssc_1_1Integral_html_a492e86b39ea36402e14876813ade570c"><div class="ttname"><a href="classsc_1_1Integral.html#a492e86b39ea36402e14876813ade570c">sc::Integral::overlap</a></div><div class="ttdeci">virtual Ref&lt; OneBodyInt &gt; overlap()=0</div><div class="ttdoc">Return a OneBodyInt that computes the overlap.</div></div>
<div class="ttc" id="aclasssc_1_1RefSCMatrix_html"><div class="ttname"><a href="classsc_1_1RefSCMatrix.html">sc::RefSCMatrix</a></div><div class="ttdoc">The RefSCMatrix class is a smart pointer to an SCMatrix specialization.</div><div class="ttdef"><b>Definition:</b> matrix.h:135</div></div>
<div class="ttc" id="aclasssc_1_1Ref_html"><div class="ttname"><a href="classsc_1_1Ref.html">sc::Ref</a></div><div class="ttdoc">A template class that maintains references counts.</div><div class="ttdef"><b>Definition:</b> ref.h:361</div></div>
<div class="ttc" id="aclasssc_1_1GetLongOpt_html_ab02cef4780e920d0af619a57d993e6c4"><div class="ttname"><a href="classsc_1_1GetLongOpt.html#ab02cef4780e920d0af619a57d993e6c4">sc::GetLongOpt::retrieve</a></div><div class="ttdeci">const char * retrieve(const char *const opt) const</div><div class="ttdoc">Retrieve an option.</div></div>
<div class="ttc" id="aclasssc_1_1Wavefunction_html"><div class="ttname"><a href="classsc_1_1Wavefunction.html">sc::Wavefunction</a></div><div class="ttdoc">A Wavefunction is a MolecularEnergy that utilizies a GaussianBasisSet.</div><div class="ttdef"><b>Definition:</b> wfn.h:52</div></div>
<div class="ttc" id="aclasssc_1_1auto__vec_html"><div class="ttname"><a href="classsc_1_1auto__vec.html">sc::auto_vec&lt; double &gt;</a></div></div>
<div class="ttc" id="aclasssc_1_1OverlapOrthog_html_a0574cd4ebac317cb6db25bfa082b606d"><div class="ttname"><a href="classsc_1_1OverlapOrthog.html#a0574cd4ebac317cb6db25bfa082b606d">sc::OverlapOrthog::basis_to_orthog_basis</a></div><div class="ttdeci">RefSCMatrix basis_to_orthog_basis()</div><div class="ttdoc">Returns a matrix which does the requested transform from a basis to an orthogonal basis.</div></div>
<div class="ttc" id="aclasssc_1_1OverlapOrthog_html"><div class="ttname"><a href="classsc_1_1OverlapOrthog.html">sc::OverlapOrthog</a></div><div class="ttdoc">This class computes the orthogonalizing transform for a basis set.</div><div class="ttdef"><b>Definition:</b> orthog.h:38</div></div>
<div class="ttc" id="aclasssc_1_1GetLongOpt_html_ab6f63467e9083a5f6d57964416d07937"><div class="ttname"><a href="classsc_1_1GetLongOpt.html#ab6f63467e9083a5f6d57964416d07937">sc::GetLongOpt::usage</a></div><div class="ttdeci">void usage(std::ostream &amp;outfile=std::cout) const</div><div class="ttdoc">Print usage information.</div></div>
<div class="ttc" id="aclasssc_1_1RefDiagSCMatrix_html"><div class="ttname"><a href="classsc_1_1RefDiagSCMatrix.html">sc::RefDiagSCMatrix</a></div><div class="ttdoc">The RefDiagSCMatrix class is a smart pointer to an DiagSCMatrix specialization.</div><div class="ttdef"><b>Definition:</b> matrix.h:389</div></div>
<div class="ttc" id="aclasssc_1_1GetLongOpt_html_a8327998237bf80c562e508cf2a3c1af6"><div class="ttname"><a href="classsc_1_1GetLongOpt.html#a8327998237bf80c562e508cf2a3c1af6">sc::GetLongOpt::parse</a></div><div class="ttdeci">int parse(int argc, char *const *argv)</div><div class="ttdoc">Parse command line options.</div></div>
<div class="ttc" id="aclasssc_1_1PetiteList_html_ab1e34d77456c28712b9b41d43ca9c7cc"><div class="ttname"><a href="classsc_1_1PetiteList.html#ab1e34d77456c28712b9b41d43ca9c7cc">sc::PetiteList::SO_basisdim</a></div><div class="ttdeci">RefSCDimension SO_basisdim()</div><div class="ttdoc">blocked SO dimension (number of blocks = order of the point group, each subdimension has 1 block)</div></div>
<div class="ttc" id="aclasssc_1_1TwoBodyInt_html_a8d1110a67d7886e6251a5d8158f603ed"><div class="ttname"><a href="classsc_1_1TwoBodyInt.html#a8d1110a67d7886e6251a5d8158f603ed">sc::TwoBodyInt::compute_shell</a></div><div class="ttdeci">virtual void compute_shell(int, int, int, int)=0</div><div class="ttdoc">Given four shell indices, integrals will be computed and placed in the buffer.</div></div>
<div class="ttc" id="aclasssc_1_1InputError_html"><div class="ttname"><a href="classsc_1_1InputError.html">sc::InputError</a></div><div class="ttdoc">This is thrown when invalid input is provided.</div><div class="ttdef"><b>Definition:</b> scexception.h:153</div></div>
<div class="ttc" id="aclasssc_1_1FeatureNotImplemented_html"><div class="ttname"><a href="classsc_1_1FeatureNotImplemented.html">sc::FeatureNotImplemented</a></div><div class="ttdoc">This is thrown when an attempt is made to use a feature that is not yet implemented.</div><div class="ttdef"><b>Definition:</b> scexception.h:120</div></div>
<div class="ttc" id="aclasssc_1_1ThreadGrp_html_a42b09fadf5257e460722b8dc50abb985"><div class="ttname"><a href="classsc_1_1ThreadGrp.html#a42b09fadf5257e460722b8dc50abb985">sc::ThreadGrp::nthread</a></div><div class="ttdeci">int nthread() const</div><div class="ttdoc">The number of threads that will be run by start_thread.</div><div class="ttdef"><b>Definition:</b> thread.h:107</div></div>
<div class="ttc" id="aclasssc_1_1SymmOneBodyIntIter_html"><div class="ttname"><a href="classsc_1_1SymmOneBodyIntIter.html">sc::SymmOneBodyIntIter</a></div><div class="ttdoc">Iterator over symmetry unique shell pairs.</div><div class="ttdef"><b>Definition:</b> symmint.h:41</div></div>
<div class="ttc" id="aclasssc_1_1KeyVal_html_a1a53bd0f1706a9a54fd9d898a610ab51"><div class="ttname"><a href="classsc_1_1KeyVal.html#a1a53bd0f1706a9a54fd9d898a610ab51">sc::KeyVal::describedclassvalue</a></div><div class="ttdeci">Ref&lt; DescribedClass &gt; describedclassvalue(const char *key=0, const KeyValValue &amp;def=KeyValValueRefDescribedClass())</div><div class="ttdoc">Returns a reference to an object of type DescribedClass.</div></div>
<div class="ttc" id="aclasssc_1_1Integral_html_a30f74e5b0aa850c7b44384d94b7b9fa3"><div class="ttname"><a href="classsc_1_1Integral.html#a30f74e5b0aa850c7b44384d94b7b9fa3">sc::Integral::petite_list</a></div><div class="ttdeci">Ref&lt; PetiteList &gt; petite_list()</div><div class="ttdoc">Return the PetiteList object.</div></div>
<div class="ttc" id="aclasssc_1_1Integral_html_ab1ccff8d6f1b4b237eed4c153b44339c"><div class="ttname"><a href="classsc_1_1Integral.html#ab1ccff8d6f1b4b237eed4c153b44339c">sc::Integral::set_default_integral</a></div><div class="ttdeci">static void set_default_integral(const Ref&lt; Integral &gt; &amp;)</div><div class="ttdoc">Specifies a new default Integral factory.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a2c8cc56d931c84679711db74facfcdff"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a2c8cc56d931c84679711db74facfcdff">sc::GaussianBasisSet::basisdim</a></div><div class="ttdeci">RefSCDimension basisdim()</div><div class="ttdoc">Returns the SCDimension object for the dimension.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:495</div></div>
<div class="ttc" id="aclasssc_1_1StateIn_html"><div class="ttname"><a href="classsc_1_1StateIn.html">sc::StateIn</a></div><div class="ttdef"><b>Definition:</b> statein.h:79</div></div>
<div class="ttc" id="aclasssc_1_1ClassDesc_html"><div class="ttname"><a href="classsc_1_1ClassDesc.html">sc::ClassDesc</a></div><div class="ttdoc">This class is used to contain information about classes.</div><div class="ttdef"><b>Definition:</b> class.h:147</div></div>
<div class="ttc" id="aclasssc_1_1PetiteList_html_a34b548a02418052530924b3ee7f76fe5"><div class="ttname"><a href="classsc_1_1PetiteList.html#a34b548a02418052530924b3ee7f76fe5">sc::PetiteList::to_AO_basis</a></div><div class="ttdeci">RefSymmSCMatrix to_AO_basis(const RefSymmSCMatrix &amp;O_so)</div><div class="ttdoc">converts an operator matrix from SO to AO basis.</div></div>
<div class="ttc" id="aclasssc_1_1MessageGrp_html_a9f088f8934d788db2e9f1e724cd66b13"><div class="ttname"><a href="classsc_1_1MessageGrp.html#a9f088f8934d788db2e9f1e724cd66b13">sc::MessageGrp::n</a></div><div class="ttdeci">int n()</div><div class="ttdoc">Returns the number of processors.</div><div class="ttdef"><b>Definition:</b> message.h:192</div></div>
<div class="ttc" id="aclasssc_1_1FockDistribution_html"><div class="ttname"><a href="classsc_1_1FockDistribution.html">sc::FockDistribution</a></div><div class="ttdoc">FockDistribution is a factory for constructing the desired FockDist specialization.</div><div class="ttdef"><b>Definition:</b> fockdist.h:187</div></div>
<div class="ttc" id="aclasssc_1_1IntegralV3_html"><div class="ttname"><a href="classsc_1_1IntegralV3.html">sc::IntegralV3</a></div><div class="ttdoc">IntegralV3 computes integrals between Gaussian basis functions.</div><div class="ttdef"><b>Definition:</b> intv3.h:41</div></div>
<div class="ttc" id="aclasssc_1_1SymmSCMatrixSCExtrapData_html"><div class="ttname"><a href="classsc_1_1SymmSCMatrixSCExtrapData.html">sc::SymmSCMatrixSCExtrapData</a></div><div class="ttdef"><b>Definition:</b> scextrapmat.h:36</div></div>
<div class="ttc" id="aclasssc_1_1Integral_html_a1b880e24e832144e16cc67fbc3ccd579"><div class="ttname"><a href="classsc_1_1Integral.html#a1b880e24e832144e16cc67fbc3ccd579">sc::Integral::hcore</a></div><div class="ttdeci">virtual Ref&lt; OneBodyInt &gt; hcore()=0</div><div class="ttdoc">Return a OneBodyInt that computes the core Hamiltonian integrals.</div></div>
<div class="ttc" id="aclasssc_1_1SymmSCMatrixSCExtrapError_html"><div class="ttname"><a href="classsc_1_1SymmSCMatrixSCExtrapError.html">sc::SymmSCMatrixSCExtrapError</a></div><div class="ttdef"><b>Definition:</b> scextrapmat.h:98</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_ae4989230715b4cda787d3d781e7db1de"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#ae4989230715b4cda787d3d781e7db1de">sc::GaussianBasisSet::molecule</a></div><div class="ttdeci">Ref&lt; Molecule &gt; molecule() const</div><div class="ttdoc">Return the Molecule object.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:489</div></div>
<div class="ttc" id="anamespacesc_html_a7bb0ab68d220f5c48055177ef8b4e39b"><div class="ttname"><a href="namespacesc.html#a7bb0ab68d220f5c48055177ef8b4e39b">sc::class_desc</a></div><div class="ttdeci">ClassDesc * class_desc()</div><div class="ttdoc">Return the ClassDesc corresponding to template argument.</div><div class="ttdef"><b>Definition:</b> class.h:257</div></div>
<div class="ttc" id="aclasssc_1_1StateOut_html"><div class="ttname"><a href="classsc_1_1StateOut.html">sc::StateOut</a></div><div class="ttdef"><b>Definition:</b> stateout.h:71</div></div>
<div class="ttc" id="aclasssc_1_1TwoBodyInt_html_a6f5897ccb457d2ba3b80387d65441022"><div class="ttname"><a href="classsc_1_1TwoBodyInt.html#a6f5897ccb457d2ba3b80387d65441022">sc::TwoBodyInt::buffer</a></div><div class="ttdeci">virtual const double * buffer(TwoBodyOper::type type=TwoBodyOper::eri) const</div><div class="ttdoc">The computed shell integrals will be put in the buffer returned by this member.</div></div>
<div class="ttc" id="aclasssc_1_1RefSCMatrix_html_a78670ab26d5b9757ae8114e1036345ea"><div class="ttname"><a href="classsc_1_1RefSCMatrix.html#a78670ab26d5b9757ae8114e1036345ea">sc::RefSCMatrix::t</a></div><div class="ttdeci">RefSCMatrix t() const</div><div class="ttdoc">Return the transpose of this.</div></div>
<div class="ttc" id="aclasssc_1_1FockBuild_html"><div class="ttname"><a href="classsc_1_1FockBuild.html">sc::FockBuild</a></div><div class="ttdoc">The FockBuild class works with the FockBuildThread class to generate Fock matrices for both closed sh...</div><div class="ttdef"><b>Definition:</b> fockbuild.h:805</div></div>
<div class="ttc" id="aclasssc_1_1FockBuild_html_a6302c16dc00cfde7ced673d3bcdf0473"><div class="ttname"><a href="classsc_1_1FockBuild.html#a6302c16dc00cfde7ced673d3bcdf0473">sc::FockBuild::build</a></div><div class="ttdeci">void build()</div><div class="ttdoc">Contruct the Fock matrices.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_ad8da790554ea38b47a1854145e0fedc9"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#ad8da790554ea38b47a1854145e0fedc9">sc::GaussianBasisSet::matrixkit</a></div><div class="ttdeci">Ref&lt; SCMatrixKit &gt; matrixkit()</div><div class="ttdoc">Returns the SCMatrixKit that is to be used for AO bases.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:491</div></div>
<div class="ttc" id="aclasssc_1_1GaussianShell_html_afb37df6ba9eddc41731a80667f302c01"><div class="ttname"><a href="classsc_1_1GaussianShell.html#afb37df6ba9eddc41731a80667f302c01">sc::GaussianShell::nfunction</a></div><div class="ttdeci">unsigned int nfunction() const</div><div class="ttdoc">The number of basis functions.</div><div class="ttdef"><b>Definition:</b> gaussshell.h:191</div></div>
<div class="ttc" id="aclasssc_1_1CLHFContribution_html"><div class="ttname"><a href="classsc_1_1CLHFContribution.html">sc::CLHFContribution</a></div><div class="ttdoc">Computes components of the Fock matrix necessary for closed-shell calculations (i....</div><div class="ttdef"><b>Definition:</b> clhfcontrib.h:17</div></div>
<div class="ttc" id="aclasssc_1_1OneBodyIntOp_html"><div class="ttname"><a href="classsc_1_1OneBodyIntOp.html">sc::OneBodyIntOp</a></div><div class="ttdef"><b>Definition:</b> obint.h:300</div></div>
<div class="ttc" id="aclasssc_1_1Integral_html_a50f4c1446a85092683d05e072237fefe"><div class="ttname"><a href="classsc_1_1Integral.html#a50f4c1446a85092683d05e072237fefe">sc::Integral::set_storage</a></div><div class="ttdeci">virtual void set_storage(size_t i)</div><div class="ttdoc">Sets the total amount of storage, in bytes, that is available.</div></div>
<div class="ttc" id="aclasssc_1_1ExEnv_html_a360216acd1f990e999c0ed46cb350b1f"><div class="ttname"><a href="classsc_1_1ExEnv.html#a360216acd1f990e999c0ed46cb350b1f">sc::ExEnv::out0</a></div><div class="ttdeci">static std::ostream &amp; out0()</div><div class="ttdoc">Return an ostream that writes from node 0.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a55005f690ee4a139175ca9f88c17ff06"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a55005f690ee4a139175ca9f88c17ff06">sc::GaussianBasisSet::so_matrixkit</a></div><div class="ttdeci">Ref&lt; SCMatrixKit &gt; so_matrixkit()</div><div class="ttdoc">Returns the SCMatrixKit that is to be used for SO bases.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:493</div></div>
<div class="ttc" id="aclasssc_1_1ThreadGrp_html_aac2daff43f786e3f61ecf6dab16b9874"><div class="ttname"><a href="classsc_1_1ThreadGrp.html#aac2daff43f786e3f61ecf6dab16b9874">sc::ThreadGrp::get_default_threadgrp</a></div><div class="ttdeci">static ThreadGrp * get_default_threadgrp()</div><div class="ttdoc">Returns the default ThreadGrp.</div></div>
<div class="ttc" id="aclasssc_1_1KeyVal_html_af3636a9ab8bf041efe790791a54bb254"><div class="ttname"><a href="classsc_1_1KeyVal.html#af3636a9ab8bf041efe790791a54bb254">sc::KeyVal::doublevalue</a></div><div class="ttdeci">double doublevalue(const char *key=0, const KeyValValue &amp;def=KeyValValuedouble())</div><div class="ttdoc">Returns the double value of key.</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_a6040fbcbccaf6b9e4ae0851d8104a5ef"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#a6040fbcbccaf6b9e4ae0851d8104a5ef">sc::GaussianBasisSet::shell_to_function</a></div><div class="ttdeci">int shell_to_function(int i) const</div><div class="ttdoc">Return the number of the first function in the given shell.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:540</div></div>
<div class="ttc" id="aclasssc_1_1DIIS_html"><div class="ttname"><a href="classsc_1_1DIIS.html">sc::DIIS</a></div><div class="ttdoc">The DIIS class provides DIIS extrapolation.</div><div class="ttdef"><b>Definition:</b> diis.h:36</div></div>
<div class="ttc" id="aclasssc_1_1GaussianBasisSet_html_aa122e5263aca50058b3651aec9f298e1"><div class="ttname"><a href="classsc_1_1GaussianBasisSet.html#aa122e5263aca50058b3651aec9f298e1">sc::GaussianBasisSet::shell</a></div><div class="ttdeci">const Shell &amp; shell(int i) const</div><div class="ttdoc">Return a reference to Shell number i.</div><div class="ttdef"><b>Definition:</b> gaussbas.h:558</div></div>
<div class="ttc" id="aclasssc_1_1GetLongOpt_html"><div class="ttname"><a href="classsc_1_1GetLongOpt.html">sc::GetLongOpt</a></div><div class="ttdoc">Parse command line options.</div><div class="ttdef"><b>Definition:</b> GetLongOpt.h:16</div></div>
<div class="ttc" id="aclasssc_1_1scprintf_html"><div class="ttname"><a href="classsc_1_1scprintf.html">sc::scprintf</a></div><div class="ttdoc">This class allows printf-like output to be sent to an ostream.</div><div class="ttdef"><b>Definition:</b> formio.h:97</div></div>
<div class="ttc" id="anamespacesc_html"><div class="ttname"><a href="namespacesc.html">sc</a></div><div class="ttdoc">Contains all MPQC code up to version 3.</div><div class="ttdef"><b>Definition:</b> mpqcin.h:14</div></div>
<hr>
<address>
<small>
Generated at Sun Jan 26 2020 23:24:02 for <a
href="http://www.mpqc.org">MPQC</a>
3.0.0-alpha using the documentation package <a
href="http://www.doxygen.org">Doxygen</a>
1.8.16.
</small>
</address>
</body>
</html>
