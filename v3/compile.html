<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC: Compiling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPQC
   &#160;<span id="projectnumber">3.0.0-alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('compile.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Compiling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>
<a class="el" href="compile.html#compiledownload">Obtaining the code</a> </li>
<li>
<a class="el" href="compile.html#compilepre">Prerequisites</a> <br  />
 </li>
<li>
<a class="el" href="compile.html#compilepreopt">Advanced Prerequisites</a> </li>
<li>
<a class="el" href="compile.html#compileconf">Configuration</a> <br  />
 </li>
<li>
<a class="el" href="compile.html#Compilers">Compilers</a> <br  />
 </li>
<li>
<a class="el" href="compile.html#Libraries">Libraries</a> <br  />
 </li>
<li>
<a class="el" href="compile.html#compilecomp">Compilation</a> </li>
<li>
<a class="el" href="compile.html#compilecheck">Checking the Compilation</a> </li>
</ul>
<h1><a class="anchor" id="compiledownload"></a>
Obtaining the code</h1>
<p>The latest version of the source code is available from <a href="https://github.com/ValeevGroup/mpqc">Github</a>. Public stable releases of MPQC have not occured since 2006. Therefore it is recommended that the users obtain the latest source code directly from the code repository.</p>
<h1><a class="anchor" id="compilepre"></a>
Prerequisites</h1>
<p>MPQC is a complex piece of software and can be customized extensively. For example, to use MPQC on a parallel machine an MPI library (see below) may be needed. While the basic subset of MPQC features will work on all platforms, advanced features of MPQC will require additional prerequisites.</p>
<p>The following programs are necessary to compile even a bare-bones version of MPQC. Most are available on any modern computer system.</p>
<ul>
<li>Code building is performed by <a href="http://cmake.org/">CMake</a>, version 2.8.8 or higher, and GNU Make.</li>
<li>Compilers for the C, C++, and FORTRAN languages are needed. The compilers listed below are known to work. Other ISO C++ compilers should work as well.<ul>
<li>GCC 4.8 and later, available from <a href="http://gcc.gnu.org">http://gcc.gnu.org</a>.</li>
<li>The Intel C/C++ compilers version 12 and later.</li>
<li>The C/C++ compiler frontend to LLVM (clang/clang++).</li>
</ul>
</li>
<li>The Basic Linear Algebra Subprograms (BLAS) and the Linear Algebra Package (LAPACK) 3.0 are required. It is preferable to use vendor-provided optimized libraries, such as Intel Math Kernel Library (MKL) or Apple's Accelerate framework. A reference copy of <a href="http://netlib.org/">netlib.org</a> LAPACK+BLAS is included and can be automatically built by cmake.</li>
<li>(optional) perl: This is used to generate and check the validation suite etc.</li>
<li>(developers-only) If you modify the scanner source file, then a lexical analyzer generator is required to generate code to read input files. The <code>flex</code> program is used for this purpose.</li>
<li>(developers-only) If you modify a parser source file, then GNU bison (version 1.24 or greater) is needed. This is a parser generator used to generate code to read input files.</li>
</ul>
<h1><a class="anchor" id="compilepreopt"></a>
Advanced Prerequisites</h1>
<p>Certain advanced features of MPQC require additional packages.</p>
<ul>
<li>A Message Passing Interface (MPI) is required to use MPQC in parallel on distributed memory machines. A thread-safe version of MPI is recommended.</li>
<li>A C++ compiler with support for the C++11 standard. Most recent versions of gcc, clang, and Intel C/C++ compiler are sufficient.</li>
<li>Libint (version 2.1.0(beta) or higher): This is a machine-generated library that can be used for evaluation of certain molecular integrals. Explicitly-correlated methods in MPQC require Libint. The library is freely available under GNU Public License (GPL) from <a href="https://github.com/evaleev/libint">Github</a>. A copy of Libint is bundled in ./external/libint*.tgz and will be built if requested. <b>NOTE</b> you may require custom version of Libint for some functionaility, such as interfacing with GAMESS.</li>
<li><a href="https://github.com/ValeevGroup/tiledarray">TiledArray</a> is a block-sparse parallel tensor framework. TiledArray must be compiled manually, preferably with support for <a href="http://libelemental.org/">Elemental</a>.</li>
<li><a href="http://eigen.tuxfamily.org/">Eigen</a> is a modern C++ library for linear algebra. A recent version is bundled in ./external/eigen.tar.gz; it will be unpacked if needed (this library is headers-only and does not need to be compiled).</li>
<li><a href="http://www.boost.org/">Boost</a> is a collection of modern C++ libraries. A recent version is bundled in ./external/boost*.tar.bz2; it will be built regardless of whether there is one is installed, since usability of Boost depends heavily on compiler.</li>
<li><a href="http://www.psicode.org/">Psi3</a> is the old generation of Psi code. Psi3 is bundled in ./external/psi3.tar.gz and will be compiled if needed. <b>NOTE:</b> Psi4 does not work with MPQC.</li>
<li><a href="http://www.hdfgroup.org/HDF5/">HDF5</a> is a high-performance data format library. It will be downloaded and built only if not found on the system.</li>
</ul>
<h1><a class="anchor" id="compileconf"></a>
Configuration</h1>
<p>You can build MPQC in the source code directory or you can make a companion target directory which will be used to hold all of the files generated by the compilation. You may name this directory anything you want. Typically, this directory is named to indicate the architecture (e.g. <code>mpqc.i686-linux</code>) and will be referred to as the target directory below.</p>
<p>A <code>configure</code> script is used to prepare MPQC for compilation. In the target directory execute the <code>configure</code> command which is located in the source directory. Use the absolute pathname to the configure script. This command should build a hierarchy of target directories and the necessary makefiles. Do a <code>configure &ndash;help</code> to see a list of options. Options are specified with an equals sign, as in <code>configure &ndash;prefix=/usr/local</code>. Some options, such as all the <code>enable</code> and <code>disable</code> options, do not require an argument. The most useful options to configure include:</p>
<dl>
<dt><code>&ndash;prefix</code></dt>
<dd><p class="startdd">Specifies the installation directory. The default is <code>/usr/local/mpqc/</code><em>version-number</em></p>
<p class="enddd"></p>
</dd>
<dt><code>&ndash;debug</code></dt>
<dd><p class="startdd">Options for debugging will be given to the compiler.</p>
<p class="enddd"></p>
</dd>
<dt><code>&ndash;new-features</code></dt>
<dd><p class="startdd">Enables compilations of all advanced features of MPQC, hence most, if not all, prerequisites will be checked and built, if needed.</p>
<p class="enddd"></p>
</dd>
</dl>
<p>If you would like to further customize your target directory, you can edit <code>src/lib/mpqc_config.h</code> to suit your needs. The next time you run configure, this files and all the makefiles will be overwritten.</p>
<h1><a class="anchor" id="Compilers"></a>
Compilers</h1>
<h2><a class="anchor" id="GNU"></a>
GNU</h2>
<p>To compile with GNU compilers: </p><div class="fragment"><div class="line">./configure CXX=g++</div>
</div><!-- fragment --><p>We are not aware of any significant issues with the GNU compilers.</p>
<h2><a class="anchor" id="Intel"></a>
Intel</h2>
<p>To compile with Intel compilers, set appropriate CXX (and optionally C and FC): </p><div class="fragment"><div class="line">./configure CXX=icpc</div>
</div><!-- fragment --><p>C++11 support is incomplete as of version 13. See <a href="http://software.intel.com/en-us/articles/c0x-features-supported-by-intel-c-compiler">C++11 Features Supported by Intel® C++ Compiler </a></p>
<p>Compiling Eigen generates lots of warnings #2536 and #2196. <br  />
 Those can be disabled with <code>-wd</code> switch, eg: </p><div class="fragment"><div class="line">./configure CXX=icpc CXXFLAGS=<span class="stringliteral">&quot;-wd2536,2196&quot;</span></div>
</div><!-- fragment --><p>Using for range loops and openmp causes Intel compilers (at least version 13.0.1) to segfault, <code>internal error: assertion failed at: "shared/cfe/edgcpfe/checkdir.c", line 5406&lt;\tt&gt;. As a workaround in production code use <a class="el" href="">foreach</a> macro.</code></p>
<p><code></code></p>
<h1><a class="anchor" id="Libraries"></a>
Libraries</h1>
<p><code> </code></p>
<h2><a class="anchor" id="LibrariesMath"></a>
BLAS/LAPACK Math Libraries</h2>
<p><code> CMake will try to find BLAS/LAPACK automatically. If it fails, a Netlib Lapack will be built and used (this is NOT recommended). You can also specify BLAS/LAPACK libraries with <code>&ndash;lapack</code> option.</code></p>
<p><code> BLAS/LAPACK libraries have <code>INTEGER</code> types that do not necessarily map to default C/C++ <code>int</code> type. The default is to assume that <code>INTEGER</code> type is 4-bytes. In case the BLAS/LAPACK library uses 8-byte types add <code>&ndash;integer8</code> flag: </p><div class="fragment"><div class="line">./configure --integer8</div>
</div><!-- fragment --><p></code></p>
<p><code> To use MKL (with GNU gfortran, GNU OpenMP, and 8-byte integers): </p><div class="fragment"><div class="line">./configure --integer8 \</div>
<div class="line">    --lapack=<span class="stringliteral">&quot;-Wl,--start-group  $(MKLROOT)/lib/intel64/libmkl_gf_ilp64.a $(MKLROOT)/lib/intel64/libmkl_core.a $(MKLROOT)/lib/intel64/libmkl_gnu_thread.a -Wl,--end-group -ldl -lpthread -lm&quot;</span></div>
</div><!-- fragment --><p></code></p>
<p><code> To use MKL with Intel compiler: </p><div class="fragment"><div class="line">./configure --lapack=<span class="stringliteral">&quot;-mkl&quot;</span></div>
</div><!-- fragment --><p></code></p>
<p><code></code></p>
<h1><a class="anchor" id="compilecomp"></a>
Compilation</h1>
<p><code> Now you are ready to build the libraries and executables. Do this by typing <code>make</code> in your target directory. If you are running on a symmetric multi-processor, you can use GNU make to parallelize the compilation. To compile four files at a time, type <code>make -j4</code>.</code></p>
<p><code> You can install the executables and data files with <code>make install</code>. Starting with version 3, this will also install the libraries and header files needed for development.</code></p>
<p><code></code></p>
<h1><a class="anchor" id="compilecheck"></a>
Checking the Compilation</h1>
<p><code> See <a class="el" href="mpqcval.html">Validating MPQC</a> for instructions for checking your compilation. </code></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr>
<address>
<small>
Generated at Sun Jan 26 2020 23:24:02 for <a
href="http://www.mpqc.org">MPQC</a>
3.0.0-alpha using the documentation package <a
href="http://www.doxygen.org">Doxygen</a>
1.8.16.
</small>
</address>
</body>
</html>
